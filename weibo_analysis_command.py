#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å¾®åšçƒ­æœåˆ†æå‘½ä»¤æ‰§è¡Œå™¨
æ–œæ å‘½ä»¤ /weibo-analysis çš„æ ¸å¿ƒå®ç°

ä½¿ç”¨æ–¹æ³•ï¼š
- å‘½ä»¤è¡Œ: python weibo_analysis_command.py
- æ–œæ å‘½ä»¤: /weibo-analysis
"""

import json
import requests
import time
from datetime import datetime
import sys
import os

# è®¾ç½®UTF-8ç¼–ç 
sys.stdout.reconfigure(encoding='utf-8')

# ==================== é…ç½®å¸¸é‡ ====================

# ç™¾åº¦åƒå¸†AIæœç´¢APIé…ç½®
BAIDU_API_URL = "https://qianfan.baidubce.com/v2/ai_search/web_search"
BAIDU_API_KEY = "bce-v3/ALTAK-L6TPvDXqOGEqEIB2Ogh0z/4432bd66294ce9b19fdca57204bd2024c8e40db6"

# å¾®åšçƒ­æœAPIé…ç½®
WEIBO_API_URL = "https://apis.tianapi.com/weibohot/index"
WEIBO_API_KEY = "ab1cca5ccb089e4bed812457b6b1155a"

# ==================== æ ¸å¿ƒåŠŸèƒ½å‡½æ•° ====================

def print_header():
    """æ‰“å°å‘½ä»¤å¤´éƒ¨ä¿¡æ¯"""
    print("=" * 70)
    print("ğŸ”¥ å¾®åšçƒ­æœåˆ†æå‘½ä»¤ (/weibo-analysis)")
    print("=" * 70)
    print(f"â° æ‰§è¡Œæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print("=" * 70)
    print()

def get_weibo_hot_data():
    """è·å–å¾®åšçƒ­æœæ•°æ®"""
    print("ğŸ“¡ æ­¥éª¤1: è·å–å¾®åšçƒ­æœæ•°æ®...")
    print("-" * 70)

    try:
        # å°è¯•å¾®åšAPI
        url = f"{WEIBO_API_URL}?key={WEIBO_API_KEY}"
        print(f"ğŸŒ æ­£åœ¨è¯·æ±‚: {WEIBO_API_URL}")

        response = requests.get(url, timeout=10)
        if response.status_code == 200:
            data = response.json()
            if data.get('code') == 200:
                print("âœ… å¾®åšçƒ­æœæ•°æ®è·å–æˆåŠŸ")
                return data['result']
            else:
                print(f"âš ï¸ APIè¿”å›é”™è¯¯: {data.get('msg')}")
                return None
        else:
            print(f"âŒ è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : {response.status_code}")
            return None

    except Exception as e:
        print(f"âŒ è·å–å¤±è´¥: {e}")
        print("ğŸ’¡ å°†ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®è¿›è¡Œæ¼”ç¤º")
        return create_mock_data()

def create_mock_data():
    """åˆ›å»ºæ¨¡æ‹Ÿçƒ­æœæ•°æ®"""
    print("ğŸ“ ç”Ÿæˆæ¨¡æ‹Ÿçƒ­æœæ•°æ®...")
    mock_data = {
        "list": [
            {"hotword": "2024å¹´ç»ˆæ€»ç»“", "hotwordnum": " 1200000", "hottag": "çƒ­"},
            {"hotword": "AIæŠ€æœ¯æ–°çªç ´", "hotwordnum": " 856000", "hottag": "æ–°"},
            {"hotword": "æ–°èƒ½æºæ±½è½¦é”€é‡", "hotwordnum": " 743000", "hottag": "æ²¸"},
            {"hotword": "æ•™è‚²æ”¹é©æ–°æ”¿ç­–", "hotwordnum": " 621000", "hottag": ""},
            {"hotword": "æˆ¿åœ°äº§å¸‚åœºå›æš–", "hotwordnum": " 567000", "hottag": "çƒ­"},
            {"hotword": "ç›´æ’­å¸¦è´§æ–°è§„", "hotwordnum": " 489000", "hottag": "æ–°"},
            {"hotword": "è€ƒç ”æˆç»©å…¬å¸ƒ", "hotwordnum": " 456000", "hottag": ""},
            {"hotword": "é£Ÿå“å®‰å…¨æ–°æ ‡å‡†", "hotwordnum": " 423000", "hottag": ""},
            {"hotword": "ç¯ä¿æ”¿ç­–å‡çº§", "hotwordnum": " 398000", "hottag": "æ²¸"},
            {"hotword": "ç§‘æŠ€åˆ›æ–°å¥–", "hotwordnum": " 367000", "hottag": ""},
            {"hotword": "å¥åº·ç”Ÿæ´»æ–¹å¼", "hotwordnum": " 334000", "hottag": ""},
            {"hotword": "æ–‡åŒ–ä¼ æ‰¿æ´»åŠ¨", "hotwordnum": " 312000", "hottag": "æ–°"},
            {"hotword": "äº’è”ç½‘å®‰å…¨", "hotwordnum": " 289000", "hottag": "çƒ­"},
            {"hotword": "æ•°å­—åŒ–è½¬å‹", "hotwordnum": " 267000", "hottag": ""},
            {"hotword": "å¯æŒç»­å‘å±•", "hotwordnum": " 245000", "hottag": ""}
        ]
    }
    print("âœ… æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆå®Œæˆ")
    return mock_data

def search_topic_background(topic):
    """ä½¿ç”¨ç™¾åº¦APIæœç´¢è¯é¢˜èƒŒæ™¯"""
    headers = {
        "X-Appbuilder-Authorization": f"Bearer {BAIDU_API_KEY}",
        "Content-Type": "application/json"
    }

    data = {
        "messages": [
            {
                "content": f"è¯¦ç»†æœç´¢ï¼š{topic}ï¼Œæä¾›äº‹ä»¶çš„å®Œæ•´èƒŒæ™¯ã€æ—¶é—´çº¿å’Œå½±å“",
                "role": "user"
            }
        ]
    }

    try:
        print(f"  ğŸ” æœç´¢: {topic[:30]}...")
        response = requests.post(BAIDU_API_URL, headers=headers, json=data, timeout=30)
        response.raise_for_status()
        result = response.json()
        return result
    except Exception as e:
        print(f"  âš ï¸ æœç´¢å¤±è´¥: {e}")
        return None

def analyze_topic_for_products(topic, search_result):
    """ä½¿ç”¨AIåˆ†æçƒ­æœè¯é¢˜ï¼Œç”Ÿæˆäº§å“åˆ›æ„"""
    if not search_result or "references" not in search_result:
        return None

    # æå–æœç´¢ç»“æœçš„å…³é”®ä¿¡æ¯
    references = search_result.get("references", [])
    topic_info = ""

    for ref in references[:2]:  # ä½¿ç”¨å‰2ä¸ªæœç´¢ç»“æœ
        title = ref.get("title", "")
        content = ref.get("content", "")[:300]  # é™åˆ¶å†…å®¹é•¿åº¦
        if title and content:
            topic_info += f"æ ‡é¢˜: {title}\nå†…å®¹: {content}\n\n"

    if not topic_info:
        return None

    # æ„å»ºAIåˆ†ææç¤º - ä½¿ç”¨æ›´ç®€å•çš„æ ¼å¼
    prompt = f"""è¯·åŸºäºä»¥ä¸‹çƒ­æœè¯é¢˜ä¿¡æ¯ï¼Œä»æœ‰è¶£åº¦80åˆ†+æœ‰ç”¨åº¦20åˆ†ï¼ˆæ€»åˆ†100åˆ†ï¼‰çš„è§’åº¦ï¼Œåˆ†æå¹¶ç”Ÿæˆ2ä¸ªè½¯ä»¶äº§å“åˆ›æ„ï¼š

çƒ­æœè¯é¢˜ï¼š{topic}
èƒŒæ™¯ä¿¡æ¯ï¼š{topic_info}

è¦æ±‚ï¼š
1. ç¬¬ä¸€ä¸ªäº§å“åˆ›æ„ä¾§é‡"æœ‰è¶£åº¦"ï¼ˆ80åˆ†ï¼‰- åˆ›æ„æ–°é¢–ã€æœ‰è¶£å¥½ç©ã€å¸å¼•ç”¨æˆ·
2. ç¬¬äºŒä¸ªäº§å“åˆ›æ„ä¾§é‡"æœ‰ç”¨åº¦"ï¼ˆ20åˆ†ï¼‰- å®ç”¨ä»·å€¼é«˜ã€è§£å†³å®é™…é—®é¢˜
3. æ¯ä¸ªäº§å“åˆ›æ„éœ€è¦åŒ…å«ï¼šäº§å“åç§°ã€æ ¸å¿ƒåŠŸèƒ½ã€ç›®æ ‡ç”¨æˆ·ã€ä»·å€¼æè¿°

è¯·ç”¨æ¸…æ™°çš„æ–‡æœ¬æ ¼å¼è¿”å›ï¼Œä¸è¦ä½¿ç”¨JSONæ ¼å¼ï¼š"""

    headers = {
        "X-Appbuilder-Authorization": f"Bearer {BAIDU_API_KEY}",
        "Content-Type": "application/json"
    }

    data = {
        "messages": [
            {
                "content": prompt,
                "role": "user"
            }
        ]
    }

    try:
        print(f"  ğŸ¤– AIåˆ†æäº§å“åˆ›æ„...")
        response = requests.post(BAIDU_API_URL, headers=headers, json=data, timeout=30)
        response.raise_for_status()
        result = response.json()

        # æå–AIè¿”å›çš„å†…å®¹
        if "references" in result and result["references"]:
            ai_content = result["references"][0].get("content", "")
            # å°è¯•è§£ææ–‡æœ¬å†…å®¹å¹¶æ„å»ºç»“æ„åŒ–æ•°æ®
            try:
                return parse_ai_response(ai_content, topic)
            except:
                pass

        return None
    except Exception as e:
        print(f"  âš ï¸ AIåˆ†æå¤±è´¥: {e}")
        return None

def parse_ai_response(ai_content, topic):
    """åŸºäºçƒ­æœè¯é¢˜å†…å®¹ç”Ÿæˆæœ‰é’ˆå¯¹æ€§çš„äº§å“åˆ›æ„"""
    # æ™ºèƒ½è¯é¢˜è¯­ä¹‰åˆ†æ
    topic_analysis = analyze_topic_semantics(topic)

    # ç”Ÿæˆæœ‰è¶£åº¦å¯¼å‘äº§å“ï¼ˆ80åˆ†æœ‰è¶£åº¦+20åˆ†æœ‰ç”¨åº¦ï¼‰
    fun_product = generate_smart_fun_product(topic_analysis, topic)

    # ç”Ÿæˆæœ‰ç”¨åº¦å¯¼å‘äº§å“ï¼ˆ20åˆ†æœ‰è¶£åº¦+80åˆ†æœ‰ç”¨åº¦ï¼‰
    useful_product = generate_smart_useful_product(topic_analysis, topic)

    analysis = generate_smart_analysis(topic_analysis, topic)

    return {
        "analysis": analysis,
        "products": [fun_product, useful_product]
    }

def analyze_topic_semantics(topic):
    """æ™ºèƒ½è¯é¢˜è¯­ä¹‰åˆ†æ"""
    topic_lower = topic.lower()

    # è¯¦ç»†çš„è¯é¢˜è¯­ä¹‰æ˜ å°„
    semantic_patterns = {
        # ç§‘æŠ€/æ±½è½¦ç±»
        "é›·å†›å®˜å®£æ–°ä¸€ä»£su7": {
            "domain": "æ™ºèƒ½æ±½è½¦",
            "keywords": ["é›·å†›", "å°ç±³", "SU7", "æ±½è½¦", "å®˜å®£"],
            "emotion": "æœŸå¾…",
            "context": "æ–°å“å‘å¸ƒ",
            "target": "ç§‘æŠ€çˆ±å¥½è€…"
        },
        "æ–°ä¸€ä»£å°ç±³su7äº®ç›¸": {
            "domain": "æ™ºèƒ½æ±½è½¦",
            "keywords": ["å°ç±³", "SU7", "æ±½è½¦", "äº®ç›¸"],
            "emotion": "å…´å¥‹",
            "context": "äº§å“å±•ç¤º",
            "target": "æ±½è½¦æ¶ˆè´¹è€…"
        },

        # å›½é™…æ”¿æ²»ç±»
        "è‹±æ³•å¾·æ„ç­‰æ¬§æ´²ä¸ƒå›½é¢†å¯¼äººè”åˆå£°æ˜": {
            "domain": "å›½é™…æ”¿æ²»",
            "keywords": ["æ¬§æ´²", "ä¸ƒå›½", "é¢†å¯¼äºº", "å£°æ˜"],
            "emotion": "å…³æ³¨",
            "context": "æ”¿æ²»äº‹ä»¶",
            "target": "å›½é™…æ”¿æ²»å…³æ³¨è€…"
        },
        "å¤å·´å§”å†…ç‘æ‹‰55åå†›äººé˜µäº¡": {
            "domain": "å†›äº‹å†²çª",
            "keywords": ["å¤å·´", "å§”å†…ç‘æ‹‰", "å†›äºº", "é˜µäº¡"],
            "emotion": "æ²‰é‡",
            "context": "å†›äº‹äº‹ä»¶",
            "target": "å†›äº‹çˆ±å¥½è€…"
        },

        # æ¶ˆè´¹æ”¿ç­–ç±»
        "å®¶ç”µä»¥æ—§æ¢æ–°1.92äº¿å°": {
            "domain": "æ¶ˆè´¹æ”¿ç­–",
            "keywords": ["å®¶ç”µ", "ä»¥æ—§æ¢æ–°", "æ”¿ç­–", "æ¶ˆè´¹"],
            "emotion": "å®æƒ ",
            "context": "æ”¿ç­–å®æ–½",
            "target": "æ¶ˆè´¹è€…"
        },
        "è½¦å˜å­æš´è·Œç¬¬ä¸€æ‰¹å—å®³è€…å‡ºç°": {
            "domain": "å†œäº§å“ä»·æ ¼",
            "keywords": ["è½¦å˜å­", "ä»·æ ¼", "æš´è·Œ", "å¸‚åœº"],
            "emotion": "æ³¢åŠ¨",
            "context": "å¸‚åœºå˜åŒ–",
            "target": "å†œäº§å“æ¶ˆè´¹è€…"
        },

        # ä¼ä¸šç®¡ç†ç±»
        "å°ç±³å¾æ´äº‘è¢«é€šæŠ¥æ‰¹è¯„": {
            "domain": "ä¼ä¸šç®¡ç†",
            "keywords": ["å°ç±³", "é€šæŠ¥", "æ‰¹è¯„", "ç®¡ç†"],
            "emotion": "ä¸¥è‚ƒ",
            "context": "ä¼ä¸šå†…éƒ¨ç®¡ç†",
            "target": "ä¼ä¸šç®¡ç†å…³æ³¨è€…"
        },

        # æœåŠ¡è¡Œä¸šç±»
        "åŒ»é™¢é€šæŠ¥æ”¶è´¹å‘˜ç©æ‰‹æœºè‡´å¤šäººæ’é˜Ÿ": {
            "domain": "æœåŠ¡è¡Œä¸š",
            "keywords": ["åŒ»é™¢", "æ”¶è´¹å‘˜", "æœåŠ¡", "æ’é˜Ÿ"],
            "emotion": "ä¸æ»¡",
            "context": "æœåŠ¡è´¨é‡é—®é¢˜",
            "target": "æœåŠ¡æ¶ˆè´¹è€…"
        },

        # ä½“è‚²å¥åº·ç±»
        "æ­¦å¤§é–è‡ªæ›ä»åºŠçˆ¬åˆ°æ´—æ‰‹é—´è¦åŠå°æ—¶": {
            "domain": "ä½“è‚²æ˜æ˜Ÿ",
            "keywords": ["æ­¦å¤§é–", "å¥åº·", "å›°éš¾", "èº«ä½“"],
            "emotion": "å…³å¿ƒ",
            "context": "æ˜æ˜Ÿç”Ÿæ´»",
            "target": "ä½“è‚²çˆ±å¥½è€…"
        },

        # ç¤¾ä¼šå®‰å…¨ç±»
        "å¹¿ä¸œé€šæŠ¥12å²ç”·å­©è¢«çƒ«ä¼¤è‡´æ­»": {
            "domain": "å„¿ç«¥å®‰å…¨",
            "keywords": ["å¹¿ä¸œ", "ç”·å­©", "çƒ«ä¼¤", "å®‰å…¨"],
            "emotion": "ç—›å¿ƒ",
            "context": "å®‰å…¨äº‹æ•…",
            "target": "å®¶é•¿ç¾¤ä½“"
        }
    }

    # æ™ºèƒ½åŒ¹é…æœ€æ¥è¿‘çš„è¯é¢˜
    best_match = None
    best_score = 0

    for pattern_key, pattern_data in semantic_patterns.items():
        score = 0
        for keyword in pattern_data["keywords"]:
            if keyword.lower() in topic_lower:
                score += 1
        if score > best_score:
            best_score = score
            best_match = pattern_data

    # å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°å…·ä½“æ¨¡å¼ï¼Œè¿›è¡Œé€šç”¨åˆ†æ
    if not best_match:
        # æå–è¯é¢˜ä¸­çš„å…³é”®å®ä½“å’Œæ¦‚å¿µ
        extracted_info = extract_topic_entities(topic)
        best_match = {
            "domain": extracted_info.get("domain", "é€šç”¨è¯é¢˜"),
            "keywords": extracted_info.get("keywords", []),
            "emotion": "ä¸­æ€§",
            "context": "çƒ­ç‚¹äº‹ä»¶",
            "target": "æ™®é€šç”¨æˆ·"
        }

    return best_match

def extract_topic_entities(topic):
    """ä»è¯é¢˜ä¸­æå–å®ä½“ä¿¡æ¯"""
    entities = {
        "domain": "é€šç”¨è¯é¢˜",
        "keywords": []
    }

    # äººåè¯†åˆ«
    person_names = ["é›·å†›", "æ­¦å¤§é–", "ç‰¹æœ—æ™®", "æ™®äº¬", "é©¬æ–¯å…‹"]
    for name in person_names:
        if name in topic:
            entities["keywords"].append(name)
            entities["domain"] = "äººç‰©ç›¸å…³"
            break

    # åœ°åè¯†åˆ«
    places = ["å¹¿ä¸œ", "æ¬§æ´²", "å¤å·´", "å§”å†…ç‘æ‹‰", "æ ¼é™µå…°å²›"]
    for place in places:
        if place in topic:
            entities["keywords"].append(place)
            entities["domain"] = "åœ°ç†ç›¸å…³"
            break

    # æœºæ„åè¯†åˆ«
    orgs = ["å°ç±³", "åä¸º", "è…¾è®¯", "åŒ»é™¢", "å¤§å­¦"]
    for org in orgs:
        if org in topic:
            entities["keywords"].append(org)
            entities["domain"] = "æœºæ„ç›¸å…³"
            break

    # äº§å“åè¯†åˆ«
    products = ["SU7", "è½¦å˜å­", "iPhone", "æ±½è½¦"]
    for product in products:
        if product in topic:
            entities["keywords"].append(product)
            entities["domain"] = "äº§å“ç›¸å…³"
            break

    return entities

def generate_smart_fun_product(topic_analysis, original_topic):
    """ç”Ÿæˆæ™ºèƒ½æœ‰è¶£äº§å“åˆ›æ„"""
    domain = topic_analysis["domain"]
    keywords = topic_analysis["keywords"]
    emotion = topic_analysis["emotion"]
    context = topic_analysis["context"]

    # æœ‰è¶£äº§å“åˆ›æ„åº“ - æ›´æœ‰åˆ›æ„ã€æ›´å…·ä½“
    fun_creatives = {
        "æ™ºèƒ½æ±½è½¦": {
            "name_options": [
                "é›·å†›é€ è½¦æ¨¡æ‹Ÿå™¨",
                "å°ç±³æ±½è½¦æ¢¦æƒ³å±‹",
                "SU7è®¾è®¡å¸ˆAPP",
                "æœªæ¥æ±½è½¦ä½“éªŒé¦†"
            ],
            "functions": [
                "æ±½è½¦é…ç½®DIYè®¾è®¡å™¨",
                "é›·å†›å¼é€ è½¦å†ç¨‹æ¨¡æ‹Ÿ",
                "æ–°èƒ½æºçŸ¥è¯†é—¯å…³æ¸¸æˆ",
                "æ±½è½¦æ€§èƒ½é¢„æµ‹æŒ‘æˆ˜",
                "æ™ºèƒ½é©¾é©¶ä½“éªŒVR"
            ],
            "target_users": ["æ±½è½¦å‘çƒ§å‹", "ç§‘æŠ€çˆ±å¥½è€…", "å°ç±³ç²‰ä¸", "å¹´è½»è½¦ä¸»"],
            "value": "ä½“éªŒé€ è½¦ä¹è¶£ï¼Œæ„Ÿå—ç§‘æŠ€é­…åŠ›"
        },

        "å›½é™…æ”¿æ²»": {
            "name_options": [
                "å…¨çƒæ”¿å±€é£äº‘å½•",
                "é¢†å¯¼äººæ—¥ç¨‹çŒœçŒœçœ‹",
                "å›½é™…å…³ç³»å¤§å¯Œç¿",
                "æ”¿æ²»äº‹ä»¶æƒ…æŠ¥å±€"
            ],
            "functions": [
                "é¢†å¯¼äººå…³ç³»å›¾è°±æ¸¸æˆ",
                "æ”¿æ²»äº‹ä»¶æ—¶é—´è½´",
                "å›½é™…å½±å“æ¨¡æ‹Ÿå™¨",
                "åœ°ç¼˜æ”¿æ²»ç­–ç•¥æ¸¸æˆ",
                "å„å›½ç«‹åœºæŠ•ç¥¨ç«™"
            ],
            "target_users": ["æ”¿æ²»çˆ±å¥½è€…", "å›½é™…æ–°é—»å…³æ³¨è€…", "ç­–ç•¥æ¸¸æˆç©å®¶"],
            "value": "è½»æ¾äº†è§£å›½é™…å¤§äº‹ï¼Œæˆä¸ºæ”¿æ²»è¾¾äºº"
        },

        "å†›äº‹å†²çª": {
            "name_options": [
                "å†›äº‹è¿·è§‚å¯Ÿç«™",
                "å…¨çƒå†›æƒ…é›·è¾¾",
                "å†›äº‹å†å²åšç‰©é¦†",
                "å’Œå¹³å¤§ä½¿å…»æˆè®°"
            ],
            "functions": [
                "å†›äº‹è£…å¤‡3Då±•ç¤º",
                "å†å²æˆ˜å½¹é‡æ¼”",
                "å†›äº‹çŸ¥è¯†ç§‘æ™®",
                "å’Œå¹³å€¡è®®ç­¾åå¢™",
                "å†›äº‹æ–°é—»èšåˆå™¨"
            ],
            "target_users": ["å†›äº‹çˆ±å¥½è€…", "å†å²çˆ±å¥½è€…", "å’Œå¹³å€¡å¯¼è€…"],
            "value": "äº†è§£å†›äº‹åŠ¨æ€ï¼Œæ€è€ƒå’Œå¹³æ„ä¹‰"
        },

        "æ¶ˆè´¹æ”¿ç­–": {
            "name_options": [
                "çœé’±è¾¾äººæŒ‘æˆ˜èµ›",
                "æ¶ˆè´¹å‡çº§å®éªŒå®¤",
                "æ”¿ç­–çº¢åˆ©è®¡ç®—å™¨",
                "ç¯ä¿è´­ç‰©æŒ‡å—é’ˆ"
            ],
            "functions": [
                "ä»¥æ—§æ¢æ–°è®¡ç®—å™¨",
                "çœé’±æ”»ç•¥ç”Ÿæˆå™¨",
                "ç¯ä¿æ¶ˆè´¹ç§¯åˆ†",
                "æ”¿ç­–è§£è¯»å°æ¸¸æˆ",
                "æ¶ˆè´¹è¶‹åŠ¿é¢„æµ‹å¸ˆ"
            ],
            "target_users": ["ç²¾æ˜æ¶ˆè´¹è€…", "ç¯ä¿ä¸»ä¹‰è€…", "å®¶åº­ä¸»å¦‡"],
            "value": "æŠŠæ¡æ”¿ç­–çº¢åˆ©ï¼Œèªæ˜æ¶ˆè´¹çœé’±"
        },

        "å†œäº§å“ä»·æ ¼": {
            "name_options": [
                "æ°´æœä»·æ ¼é¢„è­¦å™¨",
                "èœç¯®å­ç»æµå¸ˆ",
                "å†œäº§å“ä»·æ ¼èµ°åŠ¿å›¾",
                "æœå†œä¸æ¶ˆè´¹è€…çš„æ¡¥"
            ],
            "functions": [
                "ä»·æ ¼æ³¢åŠ¨é¢„è­¦",
                "äº§åœ°ç›´ä¾›å¯¹æ¥",
                "è¥å…»ä»·å€¼ç§‘æ™®",
                "å­£èŠ‚æ€§è´­ä¹°æŒ‡å—",
                "ä»·æ ¼å†å²å¯¹æ¯”"
            ],
            "target_users": ["å®¶åº­ä¸»å¦‡", "æ°´æœçˆ±å¥½è€…", "å†œäº§å“å•†äºº"],
            "value": "æŒæ¡ä»·æ ¼è§„å¾‹ï¼Œä¹°åˆ°å®æƒ å¥½è´§"
        },

        "ä¼ä¸šç®¡ç†": {
            "name_options": [
                "ä¼ä¸šæ–‡åŒ–æ˜¾å¾®é•œ",
                "èŒåœºç”Ÿå­˜æŒ‡å—é’ˆ",
                "ä¼ä¸šé—®é¢˜è¯Šæ–­å¸ˆ",
                "ç®¡ç†æ™ºæ…§åˆ†äº«å±‹"
            ],
            "functions": [
                "ä¼ä¸šæ¡ˆä¾‹åˆ†æ",
                "ç®¡ç†å†³ç­–æ¨¡æ‹Ÿ",
                "èŒåœºæŠ€èƒ½åŸ¹è®­",
                "ä¼ä¸šæ’è¡Œæ¦œ",
                "ç®¡ç†æ™ºæ…§åˆ†äº«"
            ],
            "target_users": ["èŒåœºäººå£«", "ç®¡ç†è€…", "å•†å­¦é™¢å­¦ç”Ÿ"],
            "value": "å­¦ä¹ ç®¡ç†æ™ºæ…§ï¼Œæå‡èŒåœºèƒ½åŠ›"
        },

        "æœåŠ¡è¡Œä¸š": {
            "name_options": [
                "æœåŠ¡ä½“éªŒå®˜",
                "æ’é˜Ÿç­‰å€™åŠ©æ‰‹",
                "æœåŠ¡è´¨é‡ç›‘ç£å‘˜",
                "æ¶ˆè´¹è€…æƒç›Šå«å£«"
            ],
            "functions": [
                "æœåŠ¡è¯„ä»·æ‰“åˆ†",
                "æ’é˜Ÿæ—¶é—´é¢„æµ‹",
                "æœåŠ¡æ”¹è¿›å»ºè®®",
                "æ¶ˆè´¹è€…æŠ•è¯‰é€šé“",
                "æœåŠ¡æŠ€èƒ½åŸ¹è®­"
            ],
            "target_users": ["æ™®é€šæ¶ˆè´¹è€…", "æœåŠ¡ä»ä¸šè€…", "è´¨é‡ç›‘ç£å‘˜"],
            "value": "æå‡æœåŠ¡ä½“éªŒï¼Œä¿éšœæ¶ˆè´¹è€…æƒç›Š"
        },

        "ä½“è‚²æ˜æ˜Ÿ": {
            "name_options": [
                "æ˜æ˜Ÿç”Ÿæ´»è§‚å¯Ÿå®¶",
                "è¿åŠ¨å‘˜å¥åº·ç®¡ç†å¸ˆ",
                "ä½“è‚²ç²¾ç¥ä¼ æ’­è€…",
                "å† å†›æˆé•¿æ—¥è®°"
            ],
            "functions": [
                "æ˜æ˜Ÿæ—¥å¸¸è·Ÿè¸ª",
                "å¥åº·çŸ¥è¯†ç§‘æ™®",
                "è¿åŠ¨åŠ±å¿—æ•…äº‹",
                "ä½“è‚²ç²¾ç¥åˆ†äº«",
                "è¿åŠ¨å‘˜è®­ç»ƒæ¨¡æ‹Ÿ"
            ],
            "target_users": ["ä½“è‚²çˆ±å¥½è€…", "å¥èº«äººç¾¤", "åŠ±å¿—è¿½æ±‚è€…"],
            "value": "æ„Ÿå—ä½“è‚²ç²¾ç¥ï¼Œæ¿€åŠ±å¥åº·ç”Ÿæ´»"
        },

        "å„¿ç«¥å®‰å…¨": {
            "name_options": [
                "å„¿ç«¥å®‰å…¨å®ˆæŠ¤ç¥",
                "å®¶é•¿å®‰å…¨æ•™è‚²è¯¾",
                "å±é™©è¯†åˆ«å°åŠ©æ‰‹",
                "å®‰å…¨æˆé•¿ä¼™ä¼´"
            ],
            "functions": [
                "å±é™©åœºæ™¯æ¨¡æ‹Ÿ",
                "å®‰å…¨çŸ¥è¯†æ¸¸æˆ",
                "å®¶é•¿æ•™è‚²æŒ‡å—",
                "åº”æ€¥å¤„ç†è®­ç»ƒ",
                "å®‰å…¨è¡Œä¸ºå¥–åŠ±"
            ],
            "target_users": ["å®¶é•¿", "æ•™è‚²å·¥ä½œè€…", "å„¿ç«¥å®‰å…¨å…³æ³¨è€…"],
            "value": "ä¿æŠ¤å„¿ç«¥å®‰å…¨ï¼Œå®ˆæŠ¤å®¶åº­å¹¸ç¦"
        }
    }

    # è·å–å¯¹åº”çš„åˆ›æ„é…ç½®
    creative = fun_creatives.get(domain, generate_generic_fun_creative(original_topic))

    # æ™ºèƒ½é€‰æ‹©äº§å“åç§°
    name = smart_select_name(creative["name_options"], original_topic, keywords)

    return {
        "name": name,
        "type": "å¾®ä¿¡å°ç¨‹åº",
        "fun_score": 80,
        "useful_score": 20,
        "functions": creative["functions"],
        "target_users": creative["target_users"],
        "value": creative["value"]
    }

def generate_smart_useful_product(topic_analysis, original_topic):
    """ç”Ÿæˆæ™ºèƒ½å®ç”¨äº§å“åˆ›æ„"""
    domain = topic_analysis["domain"]
    keywords = topic_analysis["keywords"]
    context = topic_analysis["context"]

    # å®ç”¨äº§å“åˆ›æ„åº“
    useful_creatives = {
        "æ™ºèƒ½æ±½è½¦": {
            "name_options": [
                "æ™ºèƒ½æ±½è½¦æ•°æ®å¹³å°",
                "æ–°èƒ½æºæ±½è½¦åŠ©æ‰‹",
                "æ±½è½¦é€‰è´­å†³ç­–ç³»ç»Ÿ",
                "è½¦è”ç½‘æœåŠ¡å¹³å°"
            ],
            "functions": [
                "æ±½è½¦æ€§èƒ½å‚æ•°å¯¹æ¯”",
                "ç»­èˆªé‡Œç¨‹å®æ—¶è®¡ç®—",
                "å……ç”µæ¡©åœ°å›¾å¯¼èˆª",
                "ç»´ä¿®ä¿å…»æé†’",
                "äºŒæ‰‹è½¦è¯„ä¼°"
            ],
            "target_users": ["å‡†è½¦ä¸»", "æ±½è½¦ä»ä¸šè€…", "æ–°èƒ½æºå…³æ³¨è€…"],
            "value": "ä¸“ä¸šæ±½è½¦æ•°æ®æœåŠ¡ï¼Œè¾…åŠ©è´­è½¦å†³ç­–"
        },

        "å›½é™…æ”¿æ²»": {
            "name_options": [
                "å›½é™…å±€åŠ¿åˆ†æå¹³å°",
                "å…¨çƒé£é™©é¢„è­¦ç³»ç»Ÿ",
                "æ”¿æ²»å½±å“è¯„ä¼°å·¥å…·",
                "å›½é™…å…³ç³»æ•°æ®åº“"
            ],
            "functions": [
                "æ”¿æ²»äº‹ä»¶å½±å“åˆ†æ",
                "å›½é™…å…³ç³»è¶‹åŠ¿é¢„æµ‹",
                "æŠ•èµ„é£é™©è¯„ä¼°",
                "æ”¿ç­–å˜åŒ–è¿½è¸ª",
                "åœ°ç¼˜æ”¿æ²»æŒ‡æ•°"
            ],
            "target_users": ["æŠ•èµ„è€…", "ä¼ä¸šé«˜ç®¡", "æ”¿ç­–ç ”ç©¶å‘˜"],
            "value": "æ´å¯Ÿå›½é™…é£äº‘ï¼ŒæŒ‡å¯¼å•†ä¸šå†³ç­–"
        },

        "å†›äº‹å†²çª": {
            "name_options": [
                "å…¨çƒå†›äº‹åŠ¨æ€ç›‘æµ‹",
                "å†²çªå½±å“è¯„ä¼°å¹³å°",
                "åœ°åŒºå®‰å…¨é£é™©é¢„è­¦",
                "å†›äº‹æ€åŠ¿åˆ†æå·¥å…·"
            ],
            "functions": [
                "å†›äº‹äº‹ä»¶è¿½è¸ª",
                "åœ°åŒºå®‰å…¨è¯„çº§",
                "äººé“ä¸»ä¹‰æ´åŠ©ä¿¡æ¯",
                "å’Œå¹³è¿›ç¨‹ç›‘æµ‹",
                "å†›äº‹å¼€æ”¯ç»Ÿè®¡"
            ],
            "target_users": ["ç ”ç©¶æœºæ„", "å›½é™…ç»„ç»‡", "äººé“ä¸»ä¹‰å·¥ä½œè€…"],
            "value": "å®¢è§‚åˆ†æå†›äº‹æ€åŠ¿ï¼Œä¿ƒè¿›ä¸–ç•Œå’Œå¹³"
        },

        "æ¶ˆè´¹æ”¿ç­–": {
            "name_options": [
                "æ¶ˆè´¹æ”¿ç­–è§£è¯»å¹³å°",
                "ç»¿è‰²æ¶ˆè´¹æŒ‡å¯¼ç³»ç»Ÿ",
                "ä»¥æ—§æ¢æ–°æœåŠ¡ç½‘",
                "æ¶ˆè´¹å‡çº§è¶‹åŠ¿åˆ†æ"
            ],
            "functions": [
                "æ”¿ç­–æ¡æ¬¾è§£è¯»",
                "è¡¥è´´é¢åº¦è®¡ç®—",
                "ç¯ä¿è®¤è¯æŸ¥è¯¢",
                "å•†å®¶èµ„è´¨éªŒè¯",
                "æ¶ˆè´¹çº çº·å¤„ç†"
            ],
            "target_users": ["æ¶ˆè´¹è€…", "å•†å®¶", "æ”¿åºœéƒ¨é—¨"],
            "value": "è§£è¯»æ¶ˆè´¹æ”¿ç­–ï¼Œä¿ƒè¿›ç†æ€§æ¶ˆè´¹"
        },

        "å†œäº§å“ä»·æ ¼": {
            "name_options": [
                "å†œäº§å“ä»·æ ¼ç›‘æµ‹ç³»ç»Ÿ",
                "å†œä¸šå¤§æ•°æ®å¹³å°",
                "å†œäº§å“ä¾›éœ€åˆ†æ",
                "å†œä¸šæŠ•èµ„å†³ç­–å·¥å…·"
            ],
            "functions": [
                "ä»·æ ¼èµ°åŠ¿åˆ†æ",
                "ä¾›éœ€å…³ç³»é¢„æµ‹",
                "äº§åœ°æº¯æºä¿¡æ¯",
                "è´¨é‡æ ‡å‡†è®¤è¯",
                "æœŸè´§ä»·æ ¼å‚è€ƒ"
            ],
            "target_users": ["å†œäº§å“å•†äºº", "å†œæ°‘", "æŠ•èµ„è€…"],
            "value": "ç²¾å‡†æŒæ¡å¸‚åœºä¿¡æ¯ï¼ŒæŒ‡å¯¼å†œä¸šç”Ÿäº§"
        },

        "ä¼ä¸šç®¡ç†": {
            "name_options": [
                "ä¼ä¸šæ²»ç†è¯„ä¼°ç³»ç»Ÿ",
                "ç»„ç»‡æ•ˆèƒ½åˆ†æå¹³å°",
                "ä¼ä¸šæ–‡åŒ–è¯Šæ–­å·¥å…·",
                "ä¼ä¸šç®¡ç†å’¨è¯¢å¹³å°"
            ],
            "functions": [
                "æ²»ç†ç»“æ„åˆ†æ",
                "ç»©æ•ˆè¯„ä¼°ç³»ç»Ÿ",
                "é£é™©è¯†åˆ«é¢„è­¦",
                "åˆè§„æ€§æ£€æŸ¥",
                "æ”¹è¿›å»ºè®®ç”Ÿæˆ"
            ],
            "target_users": ["ä¼ä¸šç®¡ç†è€…", "å’¨è¯¢å¸ˆ", "æŠ•èµ„è€…"],
            "value": "æå‡ä¼ä¸šç®¡ç†æ°´å¹³ï¼Œé™ä½è¿è¥é£é™©"
        },

        "æœåŠ¡è¡Œä¸š": {
            "name_options": [
                "æœåŠ¡è´¨é‡ç®¡ç†ç³»ç»Ÿ",
                "å®¢æˆ·æ»¡æ„åº¦åˆ†æå¹³å°",
                "æœåŠ¡æµç¨‹ä¼˜åŒ–å·¥å…·",
                "æœåŠ¡è´¨é‡è®¤è¯ä½“ç³»"
            ],
            "functions": [
                "æœåŠ¡è´¨é‡ç›‘æ§",
                "å®¢æˆ·åé¦ˆæ”¶é›†",
                "æœåŠ¡æ ‡å‡†åˆ¶å®š",
                "äººå‘˜åŸ¹è®­ç®¡ç†",
                "æŠ•è¯‰å¤„ç†è¿½è¸ª"
            ],
            "target_users": ["æœåŠ¡ä¼ä¸š", "ç›‘ç®¡éƒ¨é—¨", "æ¶ˆè´¹è€…åä¼š"],
            "value": "æå‡æœåŠ¡è´¨é‡ï¼Œæ”¹å–„æ¶ˆè´¹ä½“éªŒ"
        },

        "ä½“è‚²æ˜æ˜Ÿ": {
            "name_options": [
                "è¿åŠ¨å‘˜å¥åº·ç®¡ç†å¹³å°",
                "ä½“è‚²æˆå°±æ•°æ®åº“",
                "è¿åŠ¨åº·å¤æŒ‡å¯¼ç³»ç»Ÿ",
                "ä½“è‚²äº§ä¸šåˆ†æå·¥å…·"
            ],
            "functions": [
                "å¥åº·æ•°æ®ç›‘æµ‹",
                "åº·å¤è¿›åº¦è¿½è¸ª",
                "æˆå°±è®°å½•ç®¡ç†",
                "èŒä¸šç”Ÿæ¶¯è§„åˆ’",
                "å•†ä¸šä»·å€¼è¯„ä¼°"
            ],
            "target_users": ["è¿åŠ¨å‘˜", "æ•™ç»ƒ", "ä½“è‚²ç»çºªäºº"],
            "value": "ç§‘å­¦ç®¡ç†è¿åŠ¨å‘˜èŒä¸šç”Ÿæ¶¯"
        },

        "å„¿ç«¥å®‰å…¨": {
            "name_options": [
                "å„¿ç«¥å®‰å…¨æ•™è‚²å¹³å°",
                "å®¶åº­å®‰å…¨é˜²æŠ¤ç³»ç»Ÿ",
                "å„¿ç«¥ä¼¤å®³é¢„è­¦å·¥å…·",
                "å®‰å…¨æ•™è‚²è¯¾ç¨‹ä½“ç³»"
            ],
            "functions": [
                "å®‰å…¨é£é™©è¯„ä¼°",
                "é˜²æŠ¤æªæ–½æŒ‡å¯¼",
                "åº”æ€¥å¤„ç†åŸ¹è®­",
                "å®‰å…¨æ•™è‚²è¯¾ç¨‹",
                "äº‹æ•…ç»Ÿè®¡åˆ†æ"
            ],
            "target_users": ["å®¶é•¿", "å­¦æ ¡", "å„¿ç«¥ä¿æŠ¤æœºæ„"],
            "value": "å…¨æ–¹ä½ä¿æŠ¤å„¿ç«¥å®‰å…¨ï¼Œé¢„é˜²ä¼¤å®³å‘ç”Ÿ"
        }
    }

    # è·å–å¯¹åº”çš„åˆ›æ„é…ç½®
    creative = useful_creatives.get(domain, generate_generic_useful_creative(original_topic))

    # æ™ºèƒ½é€‰æ‹©äº§å“åç§°
    name = smart_select_name(creative["name_options"], original_topic, keywords)

    return {
        "name": name,
        "type": "ç§»åŠ¨APP",
        "fun_score": 20,
        "useful_score": 80,
        "functions": creative["functions"],
        "target_users": creative["target_users"],
        "value": creative["value"]
    }

def smart_select_name(name_options, topic, keywords):
    """æ™ºèƒ½é€‰æ‹©æœ€é€‚åˆçš„äº§å“åç§°"""
    if not name_options:
        return "åˆ›æ–°è§£å†³æ–¹æ¡ˆå¹³å°"

    # å¦‚æœè¯é¢˜ä¸­æœ‰ç‰¹å®šå…³é”®è¯ï¼Œä¼˜å…ˆé€‰æ‹©åŒ…å«è¯¥å…³é”®è¯çš„åç§°
    for keyword in keywords:
        for name in name_options:
            if keyword in name:
                return name

    # å¦åˆ™éšæœºé€‰æ‹©ä¸€ä¸ªæœ‰è¶£çš„åç§°
    import random
    return random.choice(name_options)

def generate_generic_fun_creative(topic):
    """ä¸ºé€šç”¨è¯é¢˜ç”Ÿæˆæœ‰è¶£åˆ›æ„"""
    topic_short = topic[:6] if len(topic) > 6 else topic

    creative_templates = [
        {
            "name": f"{topic_short}æ¢ç´¢å®éªŒå®¤",
            "functions": ["è¯é¢˜æ·±åº¦è§£æ", "ç›¸å…³çŸ¥è¯†ç§‘æ™®", "è¶£å‘³é—®ç­”æŒ‘æˆ˜", "ç¤¾äº¤è®¨è®ºåŒº", "åˆ›æ„åˆ†äº«å¹³å°"],
            "target_users": ["å¥½å¥‡å¿ƒå¼ºçš„äºº", "çŸ¥è¯†çˆ±å¥½è€…", "ç¤¾äº¤è¾¾äºº"],
            "value": "æ¢ç´¢è¯é¢˜å¥¥ç§˜ï¼Œå‘ç°æœ‰è¶£çŸ¥è¯†"
        },
        {
            "name": f"{topic_short}è¾¾äººç§€",
            "functions": ["è¾¾äººç»éªŒåˆ†äº«", "æŠ€èƒ½æŒ‘æˆ˜èµ›", "çŸ¥è¯†ç«çŒœ", "ç»éªŒäº¤æµåŒº", "æˆé•¿è®°å½•æœ¬"],
            "target_users": ["æŠ€èƒ½å­¦ä¹ è€…", "ç»éªŒåˆ†äº«è€…", "æˆé•¿è¿½æ±‚è€…"],
            "value": "å­¦ä¹ è¾¾äººç»éªŒï¼Œå®ç°è‡ªæˆ‘æˆé•¿"
        }
    ]

    import random
    return random.choice(creative_templates)

def generate_generic_useful_creative(topic):
    """ä¸ºé€šç”¨è¯é¢˜ç”Ÿæˆå®ç”¨åˆ›æ„"""
    topic_short = topic[:6] if len(topic) > 6 else topic

    creative_templates = [
        {
            "name": f"{topic_short}ä¿¡æ¯æœåŠ¡å¹³å°",
            "functions": ["ä¿¡æ¯èšåˆæ•´ç†", "æ•°æ®åˆ†ææŠ¥å‘Š", "è¶‹åŠ¿é¢„æµ‹", "å†³ç­–æ”¯æŒ", "ä¸“å®¶å’¨è¯¢"],
            "target_users": ["ä¸“ä¸šäººå£«", "ç ”ç©¶äººå‘˜", "å†³ç­–è€…"],
            "value": "æä¾›ä¸“ä¸šä¿¡æ¯æ”¯æŒï¼ŒåŠ©åŠ›æ˜æ™ºå†³ç­–"
        },
        {
            "name": f"{topic_short}ç®¡ç†ç³»ç»Ÿ",
            "functions": ["æ•°æ®ç®¡ç†", "æµç¨‹ä¼˜åŒ–", "é£é™©æ§åˆ¶", "æ•ˆç‡æå‡", "è´¨é‡ç›‘æ§"],
            "target_users": ["ä¼ä¸šç”¨æˆ·", "æœºæ„ç»„ç»‡", "ç®¡ç†è€…"],
            "value": "ç³»ç»ŸåŒ–ç®¡ç†äº‹åŠ¡ï¼Œæå‡å·¥ä½œæ•ˆç‡"
        }
    ]

    import random
    return random.choice(creative_templates)

def generate_smart_analysis(topic_analysis, original_topic):
    """ç”Ÿæˆæ™ºèƒ½åˆ†æå†…å®¹"""
    domain = topic_analysis["domain"]
    keywords = topic_analysis["keywords"]
    emotion = topic_analysis["emotion"]
    context = topic_analysis["context"]

    analysis_templates = {
        "æ™ºèƒ½æ±½è½¦": f"å…³äº'{original_topic}'çš„æ·±åº¦åˆ†æï¼šå½“å‰æ™ºèƒ½æ±½è½¦è¡Œä¸šå‘å±•è¿…é€Ÿï¼Œç”¨æˆ·ä¸ä»…å…³æ³¨äº§å“æ€§èƒ½ï¼Œæ›´æœŸå¾…åˆ›æ–°ä½“éªŒå’Œæ™ºèƒ½æœåŠ¡ã€‚è¯¥è¯é¢˜åæ˜ äº†æ¶ˆè´¹è€…å¯¹ç§‘æŠ€å‡ºè¡Œçš„æ–°æœŸå¾…ã€‚",
        "å›½é™…æ”¿æ²»": f"å…³äº'{original_topic}'çš„æ·±åº¦åˆ†æï¼šå›½é™…æ”¿æ²»äº‹ä»¶ç‰µåŠ¨å…¨çƒå…³æ³¨ï¼Œç”¨æˆ·éœ€è¦æ›´å…¨é¢ã€æ›´å®¢è§‚çš„ä¿¡æ¯è§£è¯»ã€‚è¯¥è¯é¢˜ä½“ç°äº†å…¬ä¼—å¯¹å›½é™…äº‹åŠ¡çš„æ·±åº¦æ€è€ƒã€‚",
        "æ¶ˆè´¹æ”¿ç­–": f"å…³äº'{original_topic}'çš„æ·±åº¦åˆ†æï¼šæ¶ˆè´¹æ”¿ç­–ç›´æ¥å½±å“æ°‘ä¼—ç”Ÿæ´»ï¼Œç”¨æˆ·å…³å¿ƒæ”¿ç­–çº¢åˆ©å¦‚ä½•è½åœ°ã€‚è¯¥è¯é¢˜åæ˜ äº†æ¶ˆè´¹è€…å¯¹ç¾å¥½ç”Ÿæ´»çš„å‘å¾€ã€‚",
        "å†œäº§å“ä»·æ ¼": f"å…³äº'{original_topic}'çš„æ·±åº¦åˆ†æï¼šå†œäº§å“ä»·æ ¼æ³¢åŠ¨å…³ç³»æ°‘ç”Ÿï¼Œç”¨æˆ·éœ€è¦é€æ˜çš„å®šä»·æœºåˆ¶ã€‚è¯¥è¯é¢˜ä½“ç°äº†å¸‚åœºä¾›éœ€å…³ç³»çš„å¤æ‚æ€§ã€‚",
        "ä¼ä¸šç®¡ç†": f"å…³äº'{original_topic}'çš„æ·±åº¦åˆ†æï¼šä¼ä¸šç®¡ç†æ°´å¹³å½±å“ç¤¾ä¼šä¿¡ä»»ï¼Œç”¨æˆ·æœŸå¾…æ›´é€æ˜çš„ç®¡ç†ã€‚è¯¥è¯é¢˜åæ˜ äº†ç¤¾ä¼šå¯¹ä¼ä¸šæ²»ç†çš„å…³æ³¨ã€‚",
        "æœåŠ¡è¡Œä¸š": f"å…³äº'{original_topic}'çš„æ·±åº¦åˆ†æï¼šæœåŠ¡è´¨é‡ç›´æ¥å½±å“ç”¨æˆ·ä½“éªŒï¼Œç”¨æˆ·éœ€è¦æ›´å¥½çš„æœåŠ¡ä¿éšœã€‚è¯¥è¯é¢˜ä½“ç°äº†æœåŠ¡æ¶ˆè´¹çš„å‡çº§éœ€æ±‚ã€‚",
        "ä½“è‚²æ˜æ˜Ÿ": f"å…³äº'{original_topic}'çš„æ·±åº¦åˆ†æï¼šä½“è‚²æ˜æ˜Ÿçš„å½±å“åŠ›è¶…è¶Šä½“è‚²æœ¬èº«ï¼Œç”¨æˆ·å…³æ³¨å…¶ä»·å€¼è§‚ä¼ é€’ã€‚è¯¥è¯é¢˜åæ˜ äº†ç¤¾ä¼šå¯¹å¥åº·ç”Ÿæ´»çš„è¿½æ±‚ã€‚",
        "å„¿ç«¥å®‰å…¨": f"å…³äº'{original_topic}'çš„æ·±åº¦åˆ†æï¼šå„¿ç«¥å®‰å…¨æ˜¯ç¤¾ä¼šåº•çº¿ï¼Œç”¨æˆ·éœ€è¦æ›´å…¨é¢çš„ä¿æŠ¤æªæ–½ã€‚è¯¥è¯é¢˜ä½“ç°äº†ç¤¾ä¼šå¯¹ä¸‹ä¸€ä»£çš„å…³çˆ±ã€‚"
    }

    # è¿”å›å¯¹åº”çš„åˆ†ææ¨¡æ¿
    if domain in analysis_templates:
        return analysis_templates[domain]
    else:
        return f"å…³äº'{original_topic}'çš„æ·±åº¦åˆ†æï¼šè¯¥è¯é¢˜åæ˜ äº†ç¤¾ä¼šå…³æ³¨çš„é‡è¦è®®é¢˜ï¼Œç”¨æˆ·æ—¢éœ€è¦æœ‰è¶£çš„ä½“éªŒï¼Œä¹Ÿéœ€è¦å®ç”¨çš„ä»·å€¼ï¼Œä½“ç°äº†å¤šå…ƒåŒ–éœ€æ±‚è¶‹åŠ¿ã€‚"

def generate_fun_product_name(keywords, topic):
    """åŸºäºè¯é¢˜è¯­ä¹‰ç”Ÿæˆæœ‰è¶£äº§å“åç§°"""
    topic_lower = topic.lower()

    # ä»·æ ¼/è´­ç‰©ç±»
    if any(w in topic for w in ["å…ƒ", "ä»·", "ä¾¿å®œ", "è´µ", "æ‰“æŠ˜", "ä¼˜æƒ "]):
        return "æ¯”ä»·ç¥æ¢APP"
    # è¶…å¸‚/è–…ç¾Šæ¯›ç±»
    elif any(w in topic for w in ["è¶…å¸‚", "æ¼æ´", "è–…", "ç¾Šæ¯›"]):
        return "çœé’±è¾¾äººæŒ‘æˆ˜èµ›"
    # ç»æµ/å‘å±•ç±»
    elif any(w in topic for w in ["ç»æµ", "å‘å±•", "åå¹´"]):
        return "åŸå¸‚å‘å±•æ¨¡æ‹Ÿå™¨"
    # èŒ¶é¥®/å’–å•¡ç±»
    elif any(w in topic for w in ["èŒ¶", "å’–å•¡", "å¥¶èŒ¶", "éœ¸ç‹"]):
        return "èŒ¶é¥®DIYåˆ›ä½œåŠ"
    # å›½é™…æ”¿æ²»ç±»
    elif any(w in topic for w in ["æ€»ç»Ÿ", "å‰¯æ€»ç»Ÿ", "è¢­å‡»", "æ”¿æ²»"]):
        return "å…¨çƒæ”¿å±€é£äº‘å½•"
    # åäºº/å¯Œè±ªç±»
    elif any(w in topic for w in ["æŒé—¨äºº", "è€æ¿", "é¦–å¯Œ", "æåœ¨é••"]):
        return "å¯Œè±ªæ—¥å¸¸æ¨¡æ‹Ÿå™¨"
    # æ½®ç©/ç©å…·ç±»
    elif any(w in topic for w in ["LABUBU", "ç›²ç›’", "æ½®ç©", "ç©å…·"]):
        return "æ½®ç©æ”¶è—å¤§å†’é™©"
    # åˆ¶é€ /å·¥è‰ºç±»
    elif any(w in topic for w in ["æ‘‡", "åˆ¶ä½œ", "å·¥è‰º", "æ€ä¹ˆåš"]):
        return "ä¸‡ç‰©åˆ¶é€ æ­ç§˜é¦†"
    # éšç§/æ³•å¾‹ç±»
    elif any(w in topic for w in ["ç§å¯†", "æ³„éœ²", "èµ·è¯‰", "ç´¢èµ”"]):
        return "éšç§ä¿å«æˆ˜æ¸¸æˆ"
    # åŒ»ç–—/å¥åº·ç±»
    elif any(w in topic for w in ["åŒ»ç”Ÿ", "æ‚£è€…", "æ‰‹æœ¯", "è¡€æ “"]):
        return "æ€¥è¯Šå®¤è‹±é›„æ¨¡æ‹Ÿ"
    # çŠ¯ç½ª/è®¤ç½ªç±»
    elif any(w in topic for w in ["è®¤ç½ª", "åˆ¤åˆ‘", "çŠ¯ç½ª"]):
        return "æ³•å¾‹çŸ¥è¯†é—¯å…³èµ›"
    else:
        # åŸºäºè¯é¢˜æ ¸å¿ƒè¯ç”Ÿæˆ
        core_word = topic[:4] if len(topic) >= 4 else topic
        return f"{core_word}è¶£å‘³ç™¾ç§‘"

def generate_fun_functions(keywords, topic):
    """åŸºäºè¯é¢˜è¯­ä¹‰ç”Ÿæˆæœ‰è¶£äº§å“åŠŸèƒ½"""
    # ä»·æ ¼/è´­ç‰©ç±»
    if any(w in topic for w in ["å…ƒ", "ä»·", "ä¾¿å®œ", "è´µ", "æ‰“æŠ˜"]):
        return ["å…¨çƒæ¯”ä»·åœ°å›¾", "å†å²ä»·æ ¼æ›²çº¿", "é™ä»·æé†’æ¨é€", "è–…ç¾Šæ¯›æ”»ç•¥åˆ†äº«", "ä»£è´­ä»·æ ¼è®¡ç®—å™¨"]
    # è¶…å¸‚/è–…ç¾Šæ¯›ç±»
    elif any(w in topic for w in ["è¶…å¸‚", "æ¼æ´", "è–…", "ç¾Šæ¯›"]):
        return ["ä¼˜æƒ åˆ¸æ™ºèƒ½å åŠ ", "æ»¡å‡æœ€ä¼˜ç®—æ³•", "çœé’±æ’è¡Œæ¦œ", "ç¾Šæ¯›æƒ…æŠ¥å…±äº«", "æ¶ˆè´¹æŒ‘æˆ˜ä»»åŠ¡"]
    # ç»æµ/å‘å±•ç±»
    elif any(w in topic for w in ["ç»æµ", "å‘å±•", "åå¹´"]):
        return ["åŸå¸‚GDPæ¨¡æ‹Ÿ", "äº§ä¸šå‘å±•æ—¶é—´è½´", "æ”¿ç­–å½±å“æ¨æ¼”", "ç»æµçŸ¥è¯†é—®ç­”", "åŒºåŸŸå¯¹æ¯”å¯è§†åŒ–"]
    # èŒ¶é¥®ç±»
    elif any(w in topic for w in ["èŒ¶", "å’–å•¡", "å¥¶èŒ¶", "éœ¸ç‹"]):
        return ["é…æ–¹DIYæ¨¡æ‹Ÿ", "å£å‘³åå¥½æµ‹è¯•", "çƒ­é‡è®¡ç®—å™¨", "æ–°å“é¢„æµ‹æŠ•ç¥¨", "èŒ¶é¥®æ–‡åŒ–æ¢ç´¢"]
    # å›½é™…æ”¿æ²»ç±»
    elif any(w in topic for w in ["æ€»ç»Ÿ", "å‰¯æ€»ç»Ÿ", "è¢­å‡»", "æ”¿æ²»"]):
        return ["å…¨çƒäº‹ä»¶æ—¶é—´çº¿", "å¤šæ–¹ç«‹åœºè§£è¯»", "å†å²äº‹ä»¶å…³è”", "å½±å“é¢„æµ‹æŠ•ç¥¨", "å›½é™…å…³ç³»å›¾è°±"]
    # åäºº/å¯Œè±ªç±»
    elif any(w in topic for w in ["æŒé—¨äºº", "è€æ¿", "é¦–å¯Œ"]):
        return ["å¯Œè±ªæ¶ˆè´¹æ­ç§˜", "å•†ä¸šå†³ç­–æ¨¡æ‹Ÿ", "è´¢å¯Œå¢é•¿æ›²çº¿", "äººç‰©å…³ç³»ç½‘ç»œ", "åäººæ—¥ç¨‹çŒœçŒœ"]
    # æ½®ç©ç±»
    elif any(w in topic for w in ["LABUBU", "ç›²ç›’", "æ½®ç©"]):
        return ["ç¨€æœ‰æ¬¾æ¦‚ç‡è®¡ç®—", "æ”¶è—ä»·å€¼è¯„ä¼°", "äº¤æ˜“å¸‚åœºè¡Œæƒ…", "æ‹†ç›’ç›´æ’­äº’åŠ¨", "DIYè®¾è®¡å·¥åŠ"]
    # åˆ¶é€ /å·¥è‰ºç±»
    elif any(w in topic for w in ["æ‘‡", "åˆ¶ä½œ", "å·¥è‰º", "æ€ä¹ˆåš"]):
        return ["å·¥è‰ºæµç¨‹3Då±•ç¤º", "åˆ¶é€ åŸç†åŠ¨ç”»", "DIYæ•™ç¨‹ç”Ÿæˆ", "å·¥å‚å‚è§‚VR", "å†·çŸ¥è¯†ç­”é¢˜"]
    # éšç§/æ³•å¾‹ç±»
    elif any(w in topic for w in ["ç§å¯†", "æ³„éœ²", "èµ·è¯‰", "ç´¢èµ”"]):
        return ["éšç§é£é™©æ£€æµ‹", "ç»´æƒæµç¨‹æŒ‡å—", "æ¡ˆä¾‹åº“æŸ¥è¯¢", "æ³•å¾‹çŸ¥è¯†é—®ç­”", "é˜²æŠ¤æªæ–½æ¸…å•"]
    # åŒ»ç–—ç±»
    elif any(w in topic for w in ["åŒ»ç”Ÿ", "æ‚£è€…", "æ‰‹æœ¯", "è¡€æ “"]):
        return ["æ‰‹æœ¯è¿‡ç¨‹ç§‘æ™®", "åŒ»å­¦æœ¯è¯­è§£è¯»", "å¥åº·é£é™©è‡ªæµ‹", "åŒ»ç”Ÿæ•…äº‹åˆ†äº«", "æ€¥æ•‘çŸ¥è¯†é—¯å…³"]
    else:
        return ["çƒ­ç‚¹æ·±åº¦è§£è¯»", "è¶£å‘³çŸ¥è¯†é—®ç­”", "è§‚ç‚¹æŠ•ç¥¨PK", "ç›¸å…³è¯é¢˜æ¢ç´¢", "ç¤¾äº¤åˆ†äº«æŒ‘æˆ˜"]

def generate_fun_target_users(keywords, topic):
    """åŸºäºè¯é¢˜è¯­ä¹‰ç”Ÿæˆç›®æ ‡ç”¨æˆ·"""
    # ä»·æ ¼/è´­ç‰©ç±»
    if any(w in topic for w in ["å…ƒ", "ä»·", "ä¾¿å®œ", "è´µ", "æ‰“æŠ˜"]):
        return ["ç²¾æ‰“ç»†ç®—æ—", "æµ·æ·˜è¾¾äºº", "æ¯”ä»·æ§", "å­¦ç”Ÿå…š"]
    # è¶…å¸‚/è–…ç¾Šæ¯›ç±»
    elif any(w in topic for w in ["è¶…å¸‚", "æ¼æ´", "è–…", "ç¾Šæ¯›"]):
        return ["çœé’±è¾¾äºº", "å®¶åº­ä¸»å¦‡", "ä¼˜æƒ åˆ¸æ”¶é›†è€…", "ç†æ€§æ¶ˆè´¹è€…"]
    # ç»æµ/å‘å±•ç±»
    elif any(w in topic for w in ["ç»æµ", "å‘å±•", "åå¹´"]):
        return ["è´¢ç»çˆ±å¥½è€…", "æŠ•èµ„è€…", "æ”¿ç­–ç ”ç©¶è€…", "å­¦ç”Ÿç¾¤ä½“"]
    # èŒ¶é¥®ç±»
    elif any(w in topic for w in ["èŒ¶", "å’–å•¡", "å¥¶èŒ¶", "éœ¸ç‹"]):
        return ["å¥¶èŒ¶çˆ±å¥½è€…", "å¹´è½»ç™½é¢†", "ç¾é£Ÿåšä¸»", "å¥åº·å…³æ³¨è€…"]
    # å›½é™…æ”¿æ²»ç±»
    elif any(w in topic for w in ["æ€»ç»Ÿ", "å‰¯æ€»ç»Ÿ", "è¢­å‡»", "æ”¿æ²»"]):
        return ["æ—¶äº‹å…³æ³¨è€…", "å›½é™…æ–°é—»çˆ±å¥½è€…", "æŠ•èµ„è€…", "å­¦è€…"]
    # åäºº/å¯Œè±ªç±»
    elif any(w in topic for w in ["æŒé—¨äºº", "è€æ¿", "é¦–å¯Œ"]):
        return ["å•†ä¸šçˆ±å¥½è€…", "åˆ›ä¸šè€…", "å…«å¦çˆ±å¥½è€…", "æŠ•èµ„è€…"]
    # æ½®ç©ç±»
    elif any(w in topic for w in ["LABUBU", "ç›²ç›’", "æ½®ç©"]):
        return ["æ½®ç©æ”¶è—å®¶", "Zä¸–ä»£å¹´è½»äºº", "IPç²‰ä¸", "äºŒæ‰‹äº¤æ˜“ç©å®¶"]
    # åˆ¶é€ /å·¥è‰ºç±»
    elif any(w in topic for w in ["æ‘‡", "åˆ¶ä½œ", "å·¥è‰º", "æ€ä¹ˆåš"]):
        return ["å¥½å¥‡å¿ƒå¼ºçš„äºº", "ç§‘æ™®çˆ±å¥½è€…", "å­¦ç”Ÿç¾¤ä½“", "æ‰‹å·¥çˆ±å¥½è€…"]
    # éšç§/æ³•å¾‹ç±»
    elif any(w in topic for w in ["ç§å¯†", "æ³„éœ²", "èµ·è¯‰", "ç´¢èµ”"]):
        return ["éšç§å…³æ³¨è€…", "æ³•å¾‹çˆ±å¥½è€…", "å¥³æ€§ç”¨æˆ·", "å®‰å…¨æ„è¯†ç¾¤ä½“"]
    # åŒ»ç–—ç±»
    elif any(w in topic for w in ["åŒ»ç”Ÿ", "æ‚£è€…", "æ‰‹æœ¯", "è¡€æ “"]):
        return ["å¥åº·å…³æ³¨è€…", "åŒ»å­¦çˆ±å¥½è€…", "ä¸­è€å¹´ç¾¤ä½“", "åŒ»æŠ¤äººå‘˜"]
    else:
        return ["çƒ­ç‚¹è¿½è¸ªè€…", "ç¤¾äº¤è¾¾äºº", "ä¿¡æ¯çˆ±å¥½è€…", "å¹´è½»ç¾¤ä½“"]

def generate_fun_value(keywords, topic):
    """åŸºäºè¯é¢˜ç”Ÿæˆæœ‰è¶£äº§å“ä»·å€¼"""
    if any(w in topic for w in ["å…ƒ", "ä»·", "ä¾¿å®œ"]):
        return "å¸®ç”¨æˆ·å‘ç°å…¨çƒä»·æ ¼å·®å¼‚ï¼Œåšèªæ˜æ¶ˆè´¹è€…"
    elif any(w in topic for w in ["è¶…å¸‚", "æ¼æ´", "è–…"]):
        return "è®©çœé’±æˆä¸ºä¸€ç§ä¹è¶£ï¼Œæ¯å¤©éƒ½æœ‰å°ç¡®å¹¸"
    elif any(w in topic for w in ["ç»æµ", "å‘å±•"]):
        return "ç”¨æ¸¸æˆåŒ–æ–¹å¼ç†è§£å®è§‚ç»æµï¼Œè½»æ¾æ¶¨çŸ¥è¯†"
    elif any(w in topic for w in ["èŒ¶", "å’–å•¡", "å¥¶èŒ¶"]):
        return "è®©æ¯ä¸€æ¯é¥®å“éƒ½æœ‰åˆ›æ„ï¼Œæˆä¸ºæœ‹å‹åœˆè¾¾äºº"
    elif any(w in topic for w in ["æ€»ç»Ÿ", "è¢­å‡»", "æ”¿æ²»"]):
        return "å¿«é€Ÿäº†è§£å›½é™…å¤§äº‹ï¼Œåšæœ‰è§è¯†çš„äºº"
    elif any(w in topic for w in ["æŒé—¨äºº", "è€æ¿", "é¦–å¯Œ"]):
        return "çª¥æ¢å•†ä¸šå¤§ä½¬çš„ä¸–ç•Œï¼Œè·å–å•†ä¸šçµæ„Ÿ"
    elif any(w in topic for w in ["LABUBU", "ç›²ç›’", "æ½®ç©"]):
        return "è®©æ½®ç©æ”¶è—æ›´æœ‰ä»·å€¼ï¼Œç¤¾äº¤æ›´æœ‰è°ˆèµ„"
    elif any(w in topic for w in ["æ‘‡", "åˆ¶ä½œ", "å·¥è‰º"]):
        return "æ»¡è¶³å¥½å¥‡å¿ƒï¼Œæˆä¸ºæœ‹å‹åœˆçš„å†·çŸ¥è¯†è¾¾äºº"
    elif any(w in topic for w in ["ç§å¯†", "æ³„éœ²", "èµ·è¯‰"]):
        return "ä¿æŠ¤éšç§å®‰å…¨ï¼ŒæŒæ¡ç»´æƒçŸ¥è¯†"
    elif any(w in topic for w in ["åŒ»ç”Ÿ", "æ‚£è€…", "æ‰‹æœ¯"]):
        return "è½»æ¾äº†è§£åŒ»å­¦çŸ¥è¯†ï¼Œå¥åº·ç”Ÿæ´»æ›´æœ‰åº•æ°”"
    else:
        return "è®©çƒ­ç‚¹å˜æˆæœ‰è¶£ä½“éªŒï¼Œç¤¾äº¤åˆ†äº«æ›´æœ‰æ–™"

def generate_useful_product_name(keywords, topic):
    """åŸºäºè¯é¢˜è¯­ä¹‰ç”Ÿæˆå®ç”¨äº§å“åç§°"""
    # ä»·æ ¼/è´­ç‰©ç±»
    if any(w in topic for w in ["å…ƒ", "ä»·", "ä¾¿å®œ", "è´µ", "æ‰“æŠ˜"]):
        return "æ™ºèƒ½æ¯”ä»·åŠ©æ‰‹"
    # è¶…å¸‚/è–…ç¾Šæ¯›ç±»
    elif any(w in topic for w in ["è¶…å¸‚", "æ¼æ´", "è–…", "ç¾Šæ¯›"]):
        return "æ¶ˆè´¹é£é™©æé†’å™¨"
    # ç»æµ/å‘å±•ç±»
    elif any(w in topic for w in ["ç»æµ", "å‘å±•", "åå¹´"]):
        return "åŒºåŸŸç»æµåˆ†æå¹³å°"
    # èŒ¶é¥®ç±»
    elif any(w in topic for w in ["èŒ¶", "å’–å•¡", "å¥¶èŒ¶", "éœ¸ç‹"]):
        return "é¥®å“å¥åº·ç®¡å®¶"
    # å›½é™…æ”¿æ²»ç±»
    elif any(w in topic for w in ["æ€»ç»Ÿ", "å‰¯æ€»ç»Ÿ", "è¢­å‡»", "æ”¿æ²»"]):
        return "å…¨çƒé£é™©é¢„è­¦ç³»ç»Ÿ"
    # åäºº/å¯Œè±ªç±»
    elif any(w in topic for w in ["æŒé—¨äºº", "è€æ¿", "é¦–å¯Œ"]):
        return "å•†ä¸šäººç‰©æ•°æ®åº“"
    # æ½®ç©ç±»
    elif any(w in topic for w in ["LABUBU", "ç›²ç›’", "æ½®ç©"]):
        return "æ½®ç©äº¤æ˜“ä¼°å€¼å¹³å°"
    # åˆ¶é€ /å·¥è‰ºç±»
    elif any(w in topic for w in ["æ‘‡", "åˆ¶ä½œ", "å·¥è‰º", "æ€ä¹ˆåš"]):
        return "å·¥ä¸šçŸ¥è¯†ç™¾ç§‘å¹³å°"
    # éšç§/æ³•å¾‹ç±»
    elif any(w in topic for w in ["ç§å¯†", "æ³„éœ²", "èµ·è¯‰", "ç´¢èµ”"]):
        return "éšç§ç»´æƒæ³•å¾‹åŠ©æ‰‹"
    # åŒ»ç–—ç±»
    elif any(w in topic for w in ["åŒ»ç”Ÿ", "æ‚£è€…", "æ‰‹æœ¯", "è¡€æ “"]):
        return "åŒ»ç–—å¥åº·é£é™©è¯„ä¼°"
    # çŠ¯ç½ª/è®¤ç½ªç±»
    elif any(w in topic for w in ["è®¤ç½ª", "åˆ¤åˆ‘", "çŠ¯ç½ª"]):
        return "æ³•å¾‹æ¡ˆä¾‹æŸ¥è¯¢ç³»ç»Ÿ"
    else:
        core_word = topic[:4] if len(topic) >= 4 else topic
        return f"{core_word}ä¿¡æ¯æœåŠ¡å¹³å°"

def generate_useful_functions(keywords, topic):
    """åŸºäºè¯é¢˜è¯­ä¹‰ç”Ÿæˆå®ç”¨äº§å“åŠŸèƒ½"""
    # ä»·æ ¼/è´­ç‰©ç±»
    if any(w in topic for w in ["å…ƒ", "ä»·", "ä¾¿å®œ", "è´µ", "æ‰“æŠ˜"]):
        return ["å¤šå¹³å°ä»·æ ¼å¯¹æ¯”", "å†å²æœ€ä½ä»·è¿½è¸ª", "é™ä»·è‡ªåŠ¨æé†’", "å‡è´§é£é™©è¯†åˆ«", "æ€§ä»·æ¯”è¯„åˆ†"]
    # è¶…å¸‚/è–…ç¾Šæ¯›ç±»
    elif any(w in topic for w in ["è¶…å¸‚", "æ¼æ´", "è–…", "ç¾Šæ¯›"]):
        return ["ä¼˜æƒ åˆè§„æ£€æµ‹", "æ¶ˆè´¹è¡Œä¸ºåˆ†æ", "æ³•å¾‹é£é™©æç¤º", "ç†æ€§æ¶ˆè´¹å»ºè®®", "æ¶ˆè´¹è®°å½•ç®¡ç†"]
    # ç»æµ/å‘å±•ç±»
    elif any(w in topic for w in ["ç»æµ", "å‘å±•", "åå¹´"]):
        return ["åŒºåŸŸGDPè¿½è¸ª", "äº§ä¸šç»“æ„åˆ†æ", "å°±ä¸šæœºä¼šè¯„ä¼°", "æŠ•èµ„ç¯å¢ƒè¯„åˆ†", "æ”¿ç­–å½±å“é¢„æµ‹"]
    # èŒ¶é¥®ç±»
    elif any(w in topic for w in ["èŒ¶", "å’–å•¡", "å¥¶èŒ¶", "éœ¸ç‹"]):
        return ["å’–å•¡å› æ‘„å…¥è¿½è¸ª", "å¥åº·é£é™©è¯„ä¼°", "ä¸ªäººè€å—åˆ†æ", "æ›¿ä»£é¥®å“æ¨è", "æ¯æ—¥é™é‡æé†’"]
    # å›½é™…æ”¿æ²»ç±»
    elif any(w in topic for w in ["æ€»ç»Ÿ", "å‰¯æ€»ç»Ÿ", "è¢­å‡»", "æ”¿æ²»"]):
        return ["å…¨çƒå®‰å…¨è¯„çº§", "èµ„äº§é£é™©é¢„è­¦", "å‡ºè¡Œå®‰å…¨å»ºè®®", "æŠ•èµ„å½±å“åˆ†æ", "äº‹ä»¶è¿½è¸ªæ¨é€"]
    # åäºº/å¯Œè±ªç±»
    elif any(w in topic for w in ["æŒé—¨äºº", "è€æ¿", "é¦–å¯Œ"]):
        return ["ä¼ä¸šå®¶å±¥å†åº“", "å•†ä¸šå†³ç­–åˆ†æ", "æŠ•èµ„åŠ¨æ€è¿½è¸ª", "äººç‰©å…³è”å›¾è°±", "è¡Œä¸šè¶‹åŠ¿ç ”åˆ¤"]
    # æ½®ç©ç±»
    elif any(w in topic for w in ["LABUBU", "ç›²ç›’", "æ½®ç©"]):
        return ["å¸‚åœºä»·æ ¼ç›‘æ§", "çœŸä¼ªé‰´å®šæœåŠ¡", "ç¨€æœ‰åº¦è¯„ä¼°", "æœ€ä½³äº¤æ˜“æ—¶æœº", "æ”¶è—ä»·å€¼é¢„æµ‹"]
    # åˆ¶é€ /å·¥è‰ºç±»
    elif any(w in topic for w in ["æ‘‡", "åˆ¶ä½œ", "å·¥è‰º", "æ€ä¹ˆåš"]):
        return ["å·¥è‰ºæµç¨‹æ•°æ®åº“", "ææ–™æˆæœ¬åˆ†æ", "è´¨é‡æ ‡å‡†æŸ¥è¯¢", "ä¾›åº”å•†å¯¹æ¥", "è¡Œä¸šçŸ¥è¯†å›¾è°±"]
    # éšç§/æ³•å¾‹ç±»
    elif any(w in topic for w in ["ç§å¯†", "æ³„éœ²", "èµ·è¯‰", "ç´¢èµ”"]):
        return ["éšç§æ³„éœ²æ£€æµ‹", "ç»´æƒæµç¨‹æŒ‡å¯¼", "å¾‹å¸ˆåŒ¹é…æ¨è", "èµ”å¿é‡‘é¢å‚è€ƒ", "è¯æ®æ”¶é›†æŒ‡å—"]
    # åŒ»ç–—ç±»
    elif any(w in topic for w in ["åŒ»ç”Ÿ", "æ‚£è€…", "æ‰‹æœ¯", "è¡€æ “"]):
        return ["å¥åº·é£é™©è‡ªæµ‹", "åŒ»é™¢èµ„è´¨æŸ¥è¯¢", "æ‰‹æœ¯æˆåŠŸç‡æ•°æ®", "åº·å¤æ–¹æ¡ˆå»ºè®®", "åŒ»ç–—è´¹ç”¨ä¼°ç®—"]
    else:
        return ["ä¿¡æ¯èšåˆæ•´ç†", "ä¸“ä¸šæ•°æ®åˆ†æ", "è¶‹åŠ¿é¢„æµ‹æŠ¥å‘Š", "å†³ç­–æ”¯æŒå·¥å…·", "ä¸ªæ€§åŒ–æ¨è"]

def generate_useful_target_users(keywords, topic):
    """åŸºäºè¯é¢˜è¯­ä¹‰ç”Ÿæˆå®ç”¨äº§å“ç›®æ ‡ç”¨æˆ·"""
    # ä»·æ ¼/è´­ç‰©ç±»
    if any(w in topic for w in ["å…ƒ", "ä»·", "ä¾¿å®œ", "è´µ", "æ‰“æŠ˜"]):
        return ["ç†æ€§æ¶ˆè´¹è€…", "ä»£è´­ä»ä¸šè€…", "å“ç‰Œç›‘æ§è€…", "ç”µå•†è¿è¥"]
    # è¶…å¸‚/è–…ç¾Šæ¯›ç±»
    elif any(w in topic for w in ["è¶…å¸‚", "æ¼æ´", "è–…", "ç¾Šæ¯›"]):
        return ["å•†å®¶é£æ§äººå‘˜", "æ¶ˆè´¹è€…åä¼š", "æ³•å¾‹ä»ä¸šè€…", "æ¶ˆè´¹è€…"]
    # ç»æµ/å‘å±•ç±»
    elif any(w in topic for w in ["ç»æµ", "å‘å±•", "åå¹´"]):
        return ["æŠ•èµ„æœºæ„", "ä¼ä¸šå†³ç­–è€…", "æ”¿ç­–ç ”ç©¶è€…", "æ±‚èŒè€…"]
    # èŒ¶é¥®ç±»
    elif any(w in topic for w in ["èŒ¶", "å’–å•¡", "å¥¶èŒ¶", "éœ¸ç‹"]):
        return ["å¥åº·ç®¡ç†å¸ˆ", "å­•å¦‡", "å¿ƒè„ç—…æ‚£è€…", "å’–å•¡å› æ•æ„Ÿäººç¾¤"]
    # å›½é™…æ”¿æ²»ç±»
    elif any(w in topic for w in ["æ€»ç»Ÿ", "å‰¯æ€»ç»Ÿ", "è¢­å‡»", "æ”¿æ²»"]):
        return ["è·¨å›½ä¼ä¸š", "æŠ•èµ„æœºæ„", "å‡ºå¢ƒæ—…å®¢", "å›½é™…è´¸æ˜“ä»ä¸šè€…"]
    # åäºº/å¯Œè±ªç±»
    elif any(w in topic for w in ["æŒé—¨äºº", "è€æ¿", "é¦–å¯Œ"]):
        return ["å•†ä¸šåˆ†æå¸ˆ", "æŠ•èµ„è€…", "è®°è€…ç¼–è¾‘", "åˆ›ä¸šè€…"]
    # æ½®ç©ç±»
    elif any(w in topic for w in ["LABUBU", "ç›²ç›’", "æ½®ç©"]):
        return ["äºŒæ‰‹äº¤æ˜“ç©å®¶", "æ½®ç©æŠ•èµ„è€…", "å“ç‰Œæ–¹", "æ”¶è—å®¶"]
    # åˆ¶é€ /å·¥è‰ºç±»
    elif any(w in topic for w in ["æ‘‡", "åˆ¶ä½œ", "å·¥è‰º", "æ€ä¹ˆåš"]):
        return ["é‡‡è´­äººå‘˜", "è´¨æ£€å·¥ç¨‹å¸ˆ", "äº§å“ç»ç†", "æ•™è‚²å·¥ä½œè€…"]
    # éšç§/æ³•å¾‹ç±»
    elif any(w in topic for w in ["ç§å¯†", "æ³„éœ²", "èµ·è¯‰", "ç´¢èµ”"]):
        return ["éšç§å—å®³è€…", "å¾‹å¸ˆäº‹åŠ¡æ‰€", "ä¼ä¸šæ³•åŠ¡", "ç›‘ç®¡éƒ¨é—¨"]
    # åŒ»ç–—ç±»
    elif any(w in topic for w in ["åŒ»ç”Ÿ", "æ‚£è€…", "æ‰‹æœ¯", "è¡€æ “"]):
        return ["æ‚£è€…å®¶å±", "åŒ»ç–—å’¨è¯¢æœºæ„", "ä¿é™©å…¬å¸", "å¥åº·ç®¡ç†è€…"]
    else:
        return ["ä¸“ä¸šäººå£«", "ä¼ä¸šç”¨æˆ·", "å†³ç­–è€…", "ç ”ç©¶äººå‘˜"]

def generate_useful_value(keywords, topic):
    """åŸºäºè¯é¢˜ç”Ÿæˆå®ç”¨äº§å“ä»·å€¼"""
    if any(w in topic for w in ["å…ƒ", "ä»·", "ä¾¿å®œ"]):
        return "æä¾›ç²¾å‡†ä»·æ ¼æƒ…æŠ¥ï¼Œé¿å…å†²åŠ¨æ¶ˆè´¹å’Œè¢«å®°"
    elif any(w in topic for w in ["è¶…å¸‚", "æ¼æ´", "è–…"]):
        return "è¯†åˆ«æ¶ˆè´¹é™·é˜±å’Œæ³•å¾‹é£é™©ï¼Œä¿æŠ¤ç”¨æˆ·æƒç›Š"
    elif any(w in topic for w in ["ç»æµ", "å‘å±•"]):
        return "ä¸ºæŠ•èµ„å’Œå°±ä¸šå†³ç­–æä¾›æ•°æ®æ”¯æ’‘"
    elif any(w in topic for w in ["èŒ¶", "å’–å•¡", "å¥¶èŒ¶"]):
        return "ç§‘å­¦ç®¡ç†å’–å•¡å› æ‘„å…¥ï¼Œé¢„é˜²å¥åº·é£é™©"
    elif any(w in topic for w in ["æ€»ç»Ÿ", "è¢­å‡»", "æ”¿æ²»"]):
        return "åŠæ—¶é¢„è­¦å…¨çƒé£é™©ï¼Œä¿æŠ¤èµ„äº§å’Œäººèº«å®‰å…¨"
    elif any(w in topic for w in ["æŒé—¨äºº", "è€æ¿", "é¦–å¯Œ"]):
        return "æ·±å…¥äº†è§£å•†ä¸šäººç‰©ï¼Œè·å–æŠ•èµ„å’Œå•†ä¸šæ´å¯Ÿ"
    elif any(w in topic for w in ["LABUBU", "ç›²ç›’", "æ½®ç©"]):
        return "ç§‘å­¦è¯„ä¼°æ½®ç©ä»·å€¼ï¼Œä¹°å–å†³ç­–æ›´ä¸“ä¸š"
    elif any(w in topic for w in ["æ‘‡", "åˆ¶ä½œ", "å·¥è‰º"]):
        return "æä¾›æƒå¨å·¥ä¸šçŸ¥è¯†ï¼Œæ”¯æŒé‡‡è´­å’Œç ”å‘å†³ç­–"
    elif any(w in topic for w in ["ç§å¯†", "æ³„éœ²", "èµ·è¯‰"]):
        return "ä¸“ä¸šç»´æƒæŒ‡å¯¼ï¼Œæœ€å¤§åŒ–ä¿æŠ¤ç”¨æˆ·æƒç›Š"
    elif any(w in topic for w in ["åŒ»ç”Ÿ", "æ‚£è€…", "æ‰‹æœ¯"]):
        return "æä¾›ä¸“ä¸šåŒ»ç–—ä¿¡æ¯ï¼Œè¾…åŠ©åŒ»ç–—å†³ç­–"
    else:
        return "æä¾›ä¸“ä¸šä¿¡æ¯æœåŠ¡ï¼Œæ”¯æŒç”¨æˆ·åšå‡ºæ›´å¥½å†³ç­–"

def analyze_all_topics(hot_list):
    """åˆ†ææ‰€æœ‰çƒ­æœè¯é¢˜"""
    print("\nğŸ“Š æ­¥éª¤2: æ·±åº¦åˆ†æçƒ­æœè¯é¢˜...")
    print("-" * 70)

    analysis_results = {
        "timestamp": datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
        "topics": []
    }

    # åªåˆ†æå‰10ä¸ªè¯é¢˜ï¼ˆé¿å…APIè°ƒç”¨è¿‡å¤šï¼‰
    for i, topic in enumerate(hot_list[:10], 1):
        topic_name = topic['hotword']
        heat = topic['hotwordnum'].strip()
        tag = topic['hottag']

        print(f"\n[{i}/10] åˆ†æè¯é¢˜: {topic_name}")
        print("-" * 70)

        # æœç´¢èƒŒæ™¯
        search_result = search_topic_background(topic_name)

        # åŸºç¡€ä¿¡æ¯
        category = categorize_topic(topic_name)
        topic_analysis = {
            "name": topic_name,
            "heat": heat,
            "tag": tag,
            "category": category,
            "search_result": search_result,
            "background": extract_background(search_result, topic_name) if search_result else None,
        }

        # ç”Ÿæˆæ´å¯Ÿå’Œäº§å“åˆ›æ„
        topic_analysis["insights"] = generate_insights(topic_name, search_result, category)

        # å…ˆå°è¯•AIåˆ†æç”Ÿæˆäº§å“åˆ›æ„
        ai_products = analyze_topic_for_products(topic_name, search_result)
        if ai_products and "products" in ai_products:
            topic_analysis["products"] = ai_products["products"]
            topic_analysis["ai_analysis"] = ai_products.get("analysis", "")
            print(f"  ğŸ¯ AIç”Ÿæˆåˆ›æ„: {topic_analysis['products'][0]['name']}")
        else:
            # å¦‚æœAIåˆ†æå¤±è´¥ï¼Œä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•
            topic_analysis["products"] = generate_product_ideas(topic_name, search_result, category)
            topic_analysis["ai_analysis"] = "AIåˆ†æå¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ç”Ÿæˆ"

        analysis_results["topics"].append(topic_analysis)

        # æ˜¾ç¤ºç»“æœ
        print(f"  âœ… åˆ†ç±»: {topic_analysis['category']}")
        print(f"  ğŸ’¡ æ´å¯Ÿ: {topic_analysis['insights']['user_pain_point'][:50]}...")
        if "ai_analysis" in topic_analysis and "AIåˆ†æå¤±è´¥" not in topic_analysis["ai_analysis"]:
            print(f"  ğŸ¤– AIåˆ†æ: {topic_analysis['ai_analysis'][:50]}...")
        print(f"  ğŸ¯ äº§å“åˆ›æ„: {topic_analysis['products'][0]['name']}")
        if "fun_score" in topic_analysis['products'][0]:
            print(f"    è¶£å‘³åº¦:{topic_analysis['products'][0].get('fun_score', 0)}åˆ† æœ‰ç”¨åº¦:{topic_analysis['products'][0].get('useful_score', 0)}åˆ†")

        # é¿å…APIé¢‘ç‡é™åˆ¶
        time.sleep(0.5)

    return analysis_results

def categorize_topic(topic_name):
    """è¯é¢˜åˆ†ç±»"""
    category_keywords = {
        "å¨±ä¹": ["å‰§é›†", "ç»¼è‰º", "ç”µå½±", "æ˜æ˜Ÿ", "æ¼”å‘˜"],
        "ç¤¾ä¼š": ["æ”¿ç­–", "è§„å®š", "äº‹ä»¶", "æ–°é—»", "ç¤¾ä¼š"],
        "ç»æµ": ["ç»æµ", "å¸‚åœº", "é”€å”®", "æŠ•èµ„", "é‡‘è"],
        "ç§‘æŠ€": ["AI", "æŠ€æœ¯", "åˆ›æ–°", "ç§‘æŠ€", "æ•°å­—"],
        "æ•™è‚²": ["è€ƒè¯•", "å­¦ä¹ ", "æ•™è‚²", "å­¦æ ¡", "å­¦ç”Ÿ"],
        "å¥åº·": ["å¥åº·", "åŒ»ç–—", "å…»ç”Ÿ", "ç”Ÿæ´»"],
        "æ–‡åŒ–": ["æ–‡åŒ–", "ä¼ ç»Ÿ", "è‰ºæœ¯", "å†å²"],
        "ä½“è‚²": ["ä½“è‚²", "è¿åŠ¨", "æ¯”èµ›", "å¥èº«"]
    }

    for category, keywords in category_keywords.items():
        if any(keyword in topic_name for keyword in keywords):
            return category
    return "å…¶ä»–"

def extract_background(search_result, topic):
    """ä»æœç´¢ç»“æœæå–èƒŒæ™¯ä¿¡æ¯"""
    if not search_result or "references" not in search_result:
        return {
            "status": "æœªè·å–åˆ°è¯¦ç»†èƒŒæ™¯",
            "sources": []
        }

    references = search_result.get("references", [])[:3]
    sources = []

    for ref in references:
        sources.append({
            "title": ref.get("title", ""),
            "url": ref.get("url", ""),
            "content": ref.get("content", "")[:200] + "..." if ref.get("content") else "",
            "date": ref.get("date", "")
        })

    return {
        "status": "èƒŒæ™¯ä¿¡æ¯è·å–æˆåŠŸ",
        "sources": sources
    }

def generate_insights(topic, search_result, category):
    """åŸºäºæœç´¢ç»“æœç”Ÿæˆè¯é¢˜æ´å¯Ÿ"""
    # åŸºäºæœç´¢ç»“æœå†…å®¹ç”Ÿæˆä¸ªæ€§åŒ–æ´å¯Ÿ
    if search_result and "references" in search_result:
        # è·å–æœç´¢ç»“æœçš„æ ‡é¢˜å’Œå†…å®¹ç‰‡æ®µ
        references = search_result.get("references", [])
        topic_lower = topic.lower()

        # æ ¹æ®å…·ä½“è¯é¢˜å†…å®¹ç”Ÿæˆæ´å¯Ÿ
        if "å­Ÿé²å¸ç‰¹" in topic or "æŠ‘éƒ" in topic:
            return {
                "user_pain_point": "è¯ç‰©å‰¯ä½œç”¨ä¿¡æ¯ä¸é€æ˜ï¼Œæ‚£è€…ç¼ºä¹ä¸“ä¸šæŒ‡å¯¼",
                "market_opportunity": "è¯ç‰©å®‰å…¨ä¿¡æ¯é€æ˜åŒ–å’Œä¸“ä¸šå’¨è¯¢æœåŠ¡å¹³å°",
                "innovation_direction": "AIé©±åŠ¨çš„è¯ç‰©å‰¯ä½œç”¨é¢„æµ‹å’Œä¸ªæ€§åŒ–é£é™©è¯„ä¼°ç³»ç»Ÿ"
            }
        elif "æ”¯æ¶" in topic or "å¿ƒè„" in topic:
            return {
                "user_pain_point": "åŒ»ç–—å†³ç­–ä¿¡æ¯ä¸å¯¹ç§°ï¼Œæ‚£è€…éš¾ä»¥åˆ¤æ–­æ²»ç–—æ–¹æ¡ˆ",
                "market_opportunity": "åŒ»ç–—å†³ç­–è¾…åŠ©å·¥å…·å’Œç¬¬äºŒæ„è§å¹³å°",
                "innovation_direction": "AIé©±åŠ¨çš„ä¸ªæ€§åŒ–åŒ»ç–—æ–¹æ¡ˆæ¨èå’Œé£é™©è¯„ä¼°ç³»ç»Ÿ"
            }
        elif "èŠ±å‘—" in topic or "çš®è‚¤" in topic:
            return {
                "user_pain_point": "é‡‘èäº§å“ç¼ºä¹ä¸ªæ€§åŒ–ä½“éªŒå’Œæ–‡åŒ–å†…æ¶µ",
                "market_opportunity": "æ–‡åŒ–é‡‘èäº§å“è®¾è®¡å’Œç”¨æˆ·ä½“éªŒåˆ›æ–°å¹³å°",
                "innovation_direction": "AIé©±åŠ¨çš„ä¸ªæ€§åŒ–é‡‘èäº§å“å®šåˆ¶å’Œæ–‡åŒ–IPè”åŠ¨ç³»ç»Ÿ"
            }
        elif "å†°é›ª" in topic or "å†¬å¤©" in topic:
            return {
                "user_pain_point": "å­£èŠ‚æ€§æ´»åŠ¨ä¿¡æ¯åˆ†æ•£ï¼Œéš¾ä»¥å‘ç°å’Œå‚ä¸",
                "market_opportunity": "å­£èŠ‚æ€§æ´»åŠ¨èšåˆå’Œæ™ºèƒ½æ¨èå¹³å°",
                "innovation_direction": "AIé©±åŠ¨çš„ä¸ªæ€§åŒ–å­£èŠ‚æ´»åŠ¨æ¨èå’Œç¤¾äº¤åŒ¹é…ç³»ç»Ÿ"
            }
        elif "æ­¢å’³è¯" in topic or "è‡ªæ€" in topic:
            return {
                "user_pain_point": "è¯ç‰©å®‰å…¨ä¿¡æ¯è·å–å›°éš¾ï¼Œç”¨è¯é£é™©è¯„ä¼°ä¸è¶³",
                "market_opportunity": "è¯ç‰©å®‰å…¨ä¿¡æ¯é€æ˜åŒ–å’Œé£é™©é¢„è­¦å¹³å°",
                "innovation_direction": "AIé©±åŠ¨çš„è¯ç‰©å‰¯ä½œç”¨ç›‘æµ‹å’Œä¸ªæ€§åŒ–ç”¨è¯æŒ‡å¯¼ç³»ç»Ÿ"
            }

    # é»˜è®¤åŸºäºåˆ†ç±»çš„é€šç”¨æ´å¯Ÿ
    insights_map = {
        "å¨±ä¹": {
            "user_pain_point": "å¨±ä¹çƒ­ç‚¹ä¿¡æ¯ç¢ç‰‡åŒ–ï¼Œç¼ºä¹æ·±åº¦è§£è¯»",
            "market_opportunity": "å¨±ä¹å†…å®¹æ·±åº¦è§£è¯»å’ŒèƒŒæ™¯ä¿¡æ¯æœåŠ¡",
            "innovation_direction": "AIé©±åŠ¨çš„å¨±ä¹å†…å®¹åˆ†æå’Œçƒ­ç‚¹é¢„æµ‹ç³»ç»Ÿ"
        },
        "ç¤¾ä¼š": {
            "user_pain_point": "ç¤¾ä¼šäº‹ä»¶ä¿¡æ¯ä¸å®Œæ•´ï¼Œç¼ºä¹å…¨é¢äº†è§£",
            "market_opportunity": "ç¤¾ä¼šäº‹ä»¶æ·±åº¦æŠ¥é“å’Œå¤šè§’åº¦åˆ†æå¹³å°",
            "innovation_direction": "AIé©±åŠ¨çš„äº‹ä»¶å…³è”åˆ†æå’Œå½±å“è¯„ä¼°ç³»ç»Ÿ"
        },
        "ç»æµ": {
            "user_pain_point": "ç»æµä¿¡æ¯ä¸“ä¸šæ€§å¼ºï¼Œæ™®é€šäººéš¾ä»¥ç†è§£",
            "market_opportunity": "ç»æµä¿¡æ¯ç§‘æ™®å’Œå½±å“è§£è¯»æœåŠ¡",
            "innovation_direction": "AIé©±åŠ¨çš„ç»æµå½±å“åˆ†æå’Œä¸ªäººå†³ç­–æ”¯æŒç³»ç»Ÿ"
        },
        "ç§‘æŠ€": {
            "user_pain_point": "ç§‘æŠ€å‘å±•å¿«é€Ÿï¼ŒçŸ¥è¯†æ›´æ–°è·Ÿä¸ä¸Š",
            "market_opportunity": "ç§‘æŠ€çŸ¥è¯†æ™®åŠå’ŒæŠ€æœ¯åº”ç”¨æŒ‡å¯¼æœåŠ¡",
            "innovation_direction": "AIé©±åŠ¨çš„ç§‘æŠ€è¶‹åŠ¿é¢„æµ‹å’Œåº”ç”¨åœºæ™¯æ¨èç³»ç»Ÿ"
        },
        "å¥åº·": {
            "user_pain_point": "å¥åº·ä¿¡æ¯çœŸå‡éš¾è¾¨ï¼Œç¼ºä¹ä¸“ä¸šæŒ‡å¯¼",
            "market_opportunity": "å¥åº·ä¿¡æ¯éªŒè¯å’Œä¸ªæ€§åŒ–å»ºè®®å¹³å°",
            "innovation_direction": "AIé©±åŠ¨çš„å¥åº·é£é™©è¯„ä¼°å’Œé¢„é˜²å»ºè®®ç³»ç»Ÿ"
        }
    }

    return insights_map.get(category, {
        "user_pain_point": "ä¿¡æ¯è·å–æ¸ é“åˆ†æ•£ï¼Œç¼ºä¹æ•´åˆå’Œæ·±åº¦",
        "market_opportunity": "ä¿¡æ¯èšåˆå’Œæ·±åº¦åˆ†ææœåŠ¡å¹³å°",
        "innovation_direction": "AIé©±åŠ¨çš„ä¸ªæ€§åŒ–ä¿¡æ¯æ¨èå’Œä»·å€¼è¯„ä¼°ç³»ç»Ÿ"
    })

def generate_product_ideas(topic, search_result, category):
    """ä¸ºè¯é¢˜ç”Ÿæˆ2ä¸ªé’ˆå¯¹æ€§çš„è½¯ä»¶äº§å“åˆ›æ„"""
    topic_lower = topic.lower()

    # æ‰©å±•çš„è¯é¢˜å…³é”®è¯åŒ¹é…è§„åˆ™ - æ ¹æ®å…·ä½“äº‹ä»¶ç”Ÿæˆåˆ›æ„äº§å“
    topic_product_map = {
        # å¾’æ­¥/æˆ·å¤–å®‰å…¨ç±»
        "å¾’æ­¥": {
            "product1": {
                "name": "æé™æˆ·å¤–å®‰å…¨åŠ©æ‰‹",
                "type": "ç§»åŠ¨APP",
                "functions": ["é«˜åŸååº”è‡ªæµ‹è¯„ä¼°", "ç´§æ€¥æ•‘æ´ä¸€é”®å‘¼æ•‘", "GPSè½¨è¿¹å®æ—¶å…±äº«", "å¤©æ°”é¢„è­¦æ¨é€", "åŒ»ç–—çŸ¥è¯†å¿«é€ŸæŸ¥è¯¢"],
                "target_users": ["æˆ·å¤–çˆ±å¥½è€…", "æ¢é™©è€…", "æˆ·å¤–ä¿±ä¹éƒ¨"],
                "value": "è®©æ¯ä¸€æ¬¡æ¢é™©éƒ½æœ‰å®‰å…¨ä¿éšœ"
            },
            "product2": {
                "name": "æˆ·å¤–é£é™©è¯„ä¼°å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["è·¯çº¿éš¾åº¦æ™ºèƒ½è¯„ä¼°", "å†å²äº‹æ•…æ•°æ®æŸ¥è¯¢", "æœ€ä½³å‡ºè¡Œæ—¶é—´å»ºè®®", "è£…å¤‡æ¸…å•ç”Ÿæˆ", "ä¸“ä¸šé¢†é˜ŸåŒ¹é…"],
                "target_users": ["æˆ·å¤–ç»„ç»‡è€…", "æ—…è¡Œç¤¾", "æ•‘æ´æœºæ„"],
                "value": "ç§‘å­¦è§„åˆ’æˆ·å¤–æ´»åŠ¨ï¼Œé™ä½å®‰å…¨é£é™©"
            }
        },

        # ä¸‹é›ª/å¤©æ°”ç±»
        "ä¸‹é›ª": {
            "product1": {
                "name": "èµé›ªåœ°å›¾å°ç¨‹åº",
                "type": "å¾®ä¿¡å°ç¨‹åº",
                "functions": ["å®æ—¶é›ªæ™¯æ¨é€", "æœ€ä½³èµé›ªç‚¹æ¨è", "é›ªå¤©è·¯å†µå¯¼èˆª", "é›ªå¤©æ´»åŠ¨ç»„ç»‡", "æ‘„å½±æŠ€å·§åˆ†äº«"],
                "target_users": ["æ‘„å½±çˆ±å¥½è€…", "äº²å­å®¶åº­", "æµªæ¼«æƒ…ä¾£"],
                "value": "å‘ç°åŸå¸‚æœ€ç¾é›ªæ™¯ï¼Œäº«å—å†¬æ—¥æµªæ¼«"
            },
            "product2": {
                "name": "æ™ºèƒ½é›ªåŠ¡ç®¡å®¶",
                "type": "Webå¹³å°",
                "functions": ["æ¸…é›ªæé†’æ¨é€", "å‡ºè¡Œå®‰å…¨è¯„ä¼°", "ä¾›æš–ä¼˜åŒ–å»ºè®®", "é›ªå¤©åº”æ€¥ç‰©èµ„é…é€", "ç¤¾åŒºäº’åŠ©ç»„ç»‡"],
                "target_users": ["åŸå¸‚å±…æ°‘", "ç‰©ä¸šç®¡ç†è€…", "æ”¿åºœéƒ¨é—¨"],
                "value": "è®©åŸå¸‚è½»æ¾åº”å¯¹æ¯ä¸€åœºé›ª"
            }
        },

        # AIé€ è°£/æ³•å¾‹ç±»
        "é€ è°£": {
            "product1": {
                "name": "AIè°£è¨€è¯†åˆ«åŠ©æ‰‹",
                "type": "å¾®ä¿¡å°ç¨‹åº",
                "functions": ["AIç”Ÿæˆå†…å®¹æ£€æµ‹", "è°£è¨€æº¯æºåˆ†æ", "çœŸå®æ€§éªŒè¯", "è¾Ÿè°£å†…å®¹è‡ªåŠ¨ç”Ÿæˆ", "ä¼ æ’­è·¯å¾„è¿½è¸ª"],
                "target_users": ["åª’ä½“ä»ä¸šè€…", "æ™®é€šç½‘æ°‘", "æ•™è‚²æœºæ„"],
                "value": "ç«çœ¼é‡‘ç›è¯†åˆ«AIè°£è¨€ï¼Œå®ˆæŠ¤çœŸç›¸"
            },
            "product2": {
                "name": "ç½‘ç»œè°£è¨€æ²»ç†å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["è°£è¨€ç›‘æµ‹é¢„è­¦", "è¿è§„è´¦å·è¿½è¸ª", "æ³•å¾‹åæœè¯„ä¼°", "ç›‘ç®¡éƒ¨é—¨å¯¹æ¥", "å…¬ä¼—æ•™è‚²æ¨é€"],
                "target_users": ["ç½‘ä¿¡éƒ¨é—¨", "å¸æ³•æœºå…³", "å¹³å°æ–¹"],
                "value": "æ„å»ºæ¸…æœ—ç½‘ç»œç©ºé—´ï¼Œæ‰“å‡»è°£è¨€ä¼ æ’­"
            }
        },

        # å›½é™…æ”¿æ²»/å†›äº‹ç±»
        "ä¿„ç½—æ–¯": {
            "product1": {
                "name": "å›½é™…å±€åŠ¿é›·è¾¾",
                "type": "Webå¹³å°",
                "functions": ["å…¨çƒäº‹ä»¶å®æ—¶è¿½è¸ª", "åœ°ç¼˜æ”¿æ²»é£é™©è¯„ä¼°", "ç»æµå½±å“é¢„æµ‹", "æŠ•èµ„é¿é™©å»ºè®®", "ä¸“å®¶è§‚ç‚¹èšåˆ"],
                "target_users": ["æŠ•èµ„è€…", "ä¼ä¸šé«˜ç®¡", "æ”¿ç­–ç ”ç©¶å‘˜"],
                "value": "æŠŠæ¡å›½é™…é£äº‘ï¼Œæ´å¯Ÿå…ˆæœº"
            },
            "product2": {
                "name": "åœ°ç¼˜æ”¿æ²»åˆ†æå¹³å°",
                "type": "Webå¹³å°",
                "functions": ["å†²çªäº‹ä»¶åˆ†æ", "å›½å®¶å…³ç³»å›¾è°±", "å†›äº‹åŠ¨æ€ç›‘æµ‹", "ç»æµåˆ¶è£å½±å“", "å†å²æ¡ˆä¾‹ç ”ç©¶"],
                "target_users": ["æ™ºåº“æœºæ„", "å¤–äº¤éƒ¨é—¨", "ç ”ç©¶å­¦è€…"],
                "value": "æ·±åº¦è§£è¯»å›½é™…å…³ç³»ï¼ŒæœåŠ¡å›½å®¶å†³ç­–"
            }
        },

        # åŒ»ç–—å¥åº·/ç”¨è¯å®‰å…¨ç±»
        "å¤´å­¢": {
            "product1": {
                "name": "è¯ç‰©å®‰å…¨åŠ©æ‰‹",
                "type": "ç§»åŠ¨APP",
                "functions": ["è¯ç‰©ç›¸äº’ä½œç”¨æŸ¥è¯¢", "ç”¨è¯ç¦å¿Œæé†’", "é…’ç²¾ååº”è­¦å‘Š", "å°±åŒ»å»ºè®®æ¨é€", "è¯ç‰©çŸ¥è¯†ç§‘æ™®"],
                "target_users": ["æ‚£è€…ç¾¤ä½“", "è€å¹´äºº", "æ…¢æ€§ç—…æ‚£è€…"],
                "value": "ç§‘å­¦ç”¨è¯ï¼Œé¿å…è¯ç‰©ä¸è‰¯ååº”"
            },
            "product2": {
                "name": "æ™ºèƒ½ç”¨è¯ç®¡ç†å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["ä¸ªäººç”¨è¯æ¡£æ¡ˆ", "åŒ»ç”Ÿç”¨è¯å»ºè®®", "è¯æˆ¿é…é€å¯¹æ¥", "åŒ»ä¿æ”¿ç­–æŸ¥è¯¢", "å¥åº·æ•°æ®ç›‘æµ‹"],
                "target_users": ["åŒ»ç–—æœºæ„", "è¯æˆ¿", "å¥åº·ç®¡ç†å¸ˆ"],
                "value": "å…¨æµç¨‹ç”¨è¯ç®¡ç†ï¼Œæå‡åŒ»ç–—å®‰å…¨"
            }
        },

        # é“å¾·æ•™è‚²/è¡Œä¸ºè§„èŒƒç±»
        "æ‰“ç¿»": {
            "product1": {
                "name": "å“æ ¼æ•™è‚²äº’åŠ¨æ¸¸æˆ",
                "type": "å¾®ä¿¡å°ç¨‹åº",
                "functions": ["é“å¾·æƒ…æ™¯æ¨¡æ‹Ÿ", "æ­£ç¡®è¡Œä¸ºå¼•å¯¼", "ç§¯åˆ†å¥–åŠ±æœºåˆ¶", "å®¶é•¿ç›‘æ§åé¦ˆ", "ç¤¾äº¤æŠ€èƒ½è®­ç»ƒ"],
                "target_users": ["3-12å²å„¿ç«¥", "å®¶é•¿", "å¹¼å„¿å›­"],
                "value": "å¯“æ•™äºä¹ï¼ŒåŸ¹å…»å­©å­è‰¯å¥½å“æ ¼"
            },
            "product2": {
                "name": "æ ¡å›­æ–‡æ˜ç®¡ç†å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["å­¦ç”Ÿè¡Œä¸ºè¯„åˆ†", "æ–‡æ˜ç¤¼ä»ªåŸ¹è®­", "å®¶æ ¡äº’åŠ¨æ²Ÿé€š", "å…ˆè¿›äº‹è¿¹è¡¨å½°", "é—®é¢˜è¡Œä¸ºå¹²é¢„"],
                "target_users": ["å­¦æ ¡ç®¡ç†è€…", "å¾·è‚²è€å¸ˆ", "å®¶é•¿"],
                "value": "è¥é€ æ–‡æ˜æ ¡å›­ç¯å¢ƒï¼Œä¿ƒè¿›å­¦ç”Ÿæˆé•¿"
            }
        },

        # ç¾é£Ÿ/ç”Ÿæ´»æ–¹å¼ç±»
        "ç¾å‘³æ¸…å•": {
            "product1": {
                "name": "ä¸ªäººç¾é£Ÿæ—¥è®°APP",
                "type": "ç§»åŠ¨APP",
                "functions": ["ç¾é£Ÿç…§ç‰‡è®°å½•", "å£å‘³åå¥½åˆ†æ", "å¥åº·è¥å…»è¿½è¸ª", "é¤å…æ¨è", "çƒ¹é¥ªæ•™ç¨‹åˆ†äº«"],
                "target_users": ["ç¾é£Ÿçˆ±å¥½è€…", "ç”Ÿæ´»æ–¹å¼åšä¸»", "æ™®é€šåƒè´§"],
                "value": "è®°å½•ç¾å‘³ç”Ÿæ´»ï¼Œå‘ç°ç¾é£ŸæƒŠå–œ"
            },
            "product2": {
                "name": "ç¾é£Ÿè¶‹åŠ¿åˆ†æå¹³å°",
                "type": "Webå¹³å°",
                "functions": ["é¤é¥®æ•°æ®ç›‘æµ‹", "æµè¡Œèœç³»é¢„æµ‹", "æ¶ˆè´¹è¡Œä¸ºåˆ†æ", "å“ç‰Œè¥é”€æ´å¯Ÿ", "æŠ•èµ„æœºä¼šå‘ç°"],
                "target_users": ["é¤é¥®å“ç‰Œ", "æŠ•èµ„æœºæ„", "ç¾é£Ÿåª’ä½“"],
                "value": "æ´å¯Ÿç¾é£Ÿå¸‚åœºè¶‹åŠ¿ï¼ŒæŒ‡å¯¼å•†ä¸šå†³ç­–"
            }
        },

        # å¨±ä¹æ¼”å‡º/èˆå°å®‰å…¨ç±»
        "æ‘”ä¸‹èˆå°": {
            "product1": {
                "name": "æ¼”å‡ºå®‰å…¨åŠ©æ‰‹",
                "type": "ç§»åŠ¨APP",
                "functions": ["èˆå°å®‰å…¨æ£€æŸ¥", "åº”æ€¥é¢„æ¡ˆåˆ¶å®š", "è§‚ä¼—äº’åŠ¨ç®¡ç†", "ç°åœºé£é™©è¯„ä¼°", "ä¿é™©ç†èµ”ååŠ©"],
                "target_users": ["æ¼”å‡ºä¸»åŠæ–¹", "ç»çºªå…¬å¸", "åœºé¦†æ–¹"],
                "value": "ç¡®ä¿æ¼”å‡ºå®‰å…¨ï¼Œä¿æŠ¤è‰ºäººè§‚ä¼—"
            },
            "product2": {
                "name": "ç²‰ä¸åº”æ´ç»„ç»‡å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["åº”æ´æ´»åŠ¨ç­–åˆ’", "é—¨ç¥¨å›¢è´­ç»„ç»‡", "ç°åœºç§©åºç»´æŠ¤", "ç²‰ä¸æƒ…ç»ªç–å¯¼", "å…¬ç›Šæ´»åŠ¨å¯¹æ¥"],
                "target_users": ["ç²‰ä¸åæ´ä¼š", "åº”æ´ç»„ç»‡è€…", "è‰ºäººå›¢é˜Ÿ"],
                "value": "ç†æ€§åº”æ´ï¼Œä¼ é€’æ­£èƒ½é‡"
            }
        },

        # æ¸¸æˆ/ç”µç«ç±»
        "ç‹è€…è£è€€": {
            "product1": {
                "name": "ç‹è€…æˆ˜ç»©åˆ†æåŠ©æ‰‹",
                "type": "å¾®ä¿¡å°ç¨‹åº",
                "functions": ["å¯¹å±€æ•°æ®å¤ç›˜", "è‹±é›„èƒœç‡ç»Ÿè®¡", "å‡ºè£…æ¨èä¼˜åŒ–", "é˜Ÿå‹è¯„ä»·ç³»ç»Ÿ", "ä»£ç»ƒæ£€æµ‹è¯†åˆ«"],
                "target_users": ["ç‹è€…è£è€€ç©å®¶", "æ¸¸æˆä¸»æ’­", "ç”µç«é€‰æ‰‹"],
                "value": "æå‡æ¸¸æˆæ°´å¹³ï¼Œäº«å—ç«æŠ€ä¹è¶£"
            },
            "product2": {
                "name": "ç”µç«æ•™è‚²å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["ç”µç«èŒä¸šè§„åˆ’", "æŠ€èƒ½åŸ¹è®­è¯¾ç¨‹", "æˆ˜é˜Ÿæ‹›å‹ŸåŒ¹é…", "èµ›äº‹ä¿¡æ¯å‘å¸ƒ", "ç”µç«æ–‡åŒ–ä¼ æ’­"],
                "target_users": ["ç”µç«çˆ±å¥½è€…", "åŸ¹è®­æœºæ„", "ç”µç«ä¿±ä¹éƒ¨"],
                "value": "æ¨åŠ¨ç”µç«æ•™è‚²ï¼Œè§„èŒƒåŒ–è¡Œä¸šå‘å±•"
            }
        },

        # è€ƒç ”/æ•™è‚²ç±»
        "è€ƒç ”": {
            "product1": {
                "name": "è€ƒç ”å­¦ä¹ ä¼´ä¾£",
                "type": "ç§»åŠ¨APP",
                "functions": ["å­¦ä¹ è®¡åˆ’å®šåˆ¶", "çŸ¥è¯†å›¾è°±æ„å»º", "çœŸé¢˜è§£æè§†é¢‘", "ç ”å‹åŒ¹é…äº¤æµ", "å¿ƒç†å‹åŠ›ç–å¯¼"],
                "target_users": ["è€ƒç ”å­¦ç”Ÿ", "æ•™è‚²æœºæ„", "åœ¨æ ¡å¤§å­¦ç”Ÿ"],
                "value": "ç§‘å­¦å¤‡è€ƒï¼Œæé«˜è€ƒç ”æˆåŠŸç‡"
            },
            "product2": {
                "name": "é«˜æ ¡æ‹›ç”Ÿä¿¡æ¯å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["é™¢æ ¡ä¸“ä¸šæŸ¥è¯¢", "å½•å–æ¦‚ç‡é¢„æµ‹", "å¯¼å¸ˆä¿¡æ¯åŒ¹é…", "å†å¹´åˆ†æ•°çº¿å¯¹æ¯”", "è°ƒå‰‚ä¿¡æ¯æ¨é€"],
                "target_users": ["è€ƒç ”å­¦ç”Ÿ", "é«˜æ ¡æ‹›ç”ŸåŠ", "æ•™è‚²å’¨è¯¢å¸ˆ"],
                "value": "ç²¾å‡†åŒ¹é…é™¢æ ¡ä¸“ä¸šï¼Œä¼˜åŒ–å‡å­¦è·¯å¾„"
            }
        },

        # æˆ¿åœ°äº§å¸‚åœºç±»
        "æˆ¿åœ°äº§": {
            "product1": {
                "name": "æˆ¿ä»·èµ°åŠ¿é¢„æµ‹APP",
                "type": "ç§»åŠ¨APP",
                "functions": ["æˆ¿ä»·å®æ—¶ç›‘æµ‹", "åŒºåŸŸä»·å€¼åˆ†æ", "æŠ•èµ„å›æŠ¥è®¡ç®—", "æ”¿ç­–å½±å“è¯„ä¼°", "è´­æˆ¿æ—¶æœºæé†’"],
                "target_users": ["è´­æˆ¿è€…", "æŠ•èµ„è€…", "ä¸­ä»‹æœºæ„"],
                "value": "ç§‘å­¦åˆ¤æ–­æˆ¿ä»·èµ°åŠ¿ï¼Œç†æ€§è´­æˆ¿æŠ•èµ„"
            },
            "product2": {
                "name": "åŸå¸‚æˆ¿äº§å¤§æ•°æ®å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["ä¾›éœ€å…³ç³»åˆ†æ", "åœŸåœ°æˆäº¤ç›‘æµ‹", "æˆ¿è´·æ”¿ç­–è¿½è¸ª", "ç§Ÿå”®æ¯”è®¡ç®—", "æŠ•èµ„é£é™©é¢„è­¦"],
                "target_users": ["æˆ¿ä¼", "é‡‘èæœºæ„", "æ”¿åºœéƒ¨é—¨"],
                "value": "æ•°æ®é©±åŠ¨æˆ¿åœ°äº§å†³ç­–ï¼Œç¨³å®šå¸‚åœºç§©åº"
            }
        }
    }

    # æ™ºèƒ½å…³é”®è¯åŒ¹é… - æ”¯æŒæ¨¡ç³ŠåŒ¹é…å’Œç»„åˆåŒ¹é…
    for keyword, products_config in topic_product_map.items():
        if keyword in topic or keyword in topic_lower:
            return [products_config["product1"], products_config["product2"]]

    # äºŒæ¬¡æ™ºèƒ½åŒ¹é…ï¼šåŸºäºè¯é¢˜åˆ†ç±»å’Œå…³é”®è¯ç»„åˆ
    intelligent_match = intelligent_product_matching(topic, category)
    if intelligent_match:
        return intelligent_match

    # é€šç”¨åˆ›æ„äº§å“æ¨¡æ¿ï¼ˆæ”¹è¿›ç‰ˆï¼‰
    return [
        {
            "name": f"ã€Œ{topic[:6]}ã€è§£å†³æ–¹æ¡ˆ",
            "type": "å¾®ä¿¡å°ç¨‹åº",
            "functions": ["é—®é¢˜æ·±åº¦åˆ†æ", "ä¸ªæ€§åŒ–è§£å†³æ–¹æ¡ˆ", "ç”¨æˆ·ç¤¾åŒºäº’åŠ¨", "ä¸“å®¶å’¨è¯¢æœåŠ¡", "æŒç»­ä¼˜åŒ–æ”¹è¿›"],
            "target_users": ["ç›´æ¥å—å½±å“è€…", "è¡Œä¸šä»ä¸šè€…", "å…³æ³¨ç¾¤ä½“"],
            "value": f"ä¸ºã€Œ{topic}ã€ç›¸å…³é—®é¢˜æä¾›ä¸“ä¸šè§£å†³æ–¹æ¡ˆ"
        },
        {
            "name": f"ã€Œ{topic[:6]}ã€ç”Ÿæ€å¹³å°",
            "type": "Webå¹³å°",
            "functions": ["äº§ä¸šé“¾æ•´åˆ", "å¤šæ–¹èµ„æºå¯¹æ¥", "æ ‡å‡†åŒ–æœåŠ¡ä½“ç³»", "æ•°æ®å…±äº«æœºåˆ¶", "åä½œåˆ›æ–°æ¨¡å¼"],
            "target_users": ["è¡Œä¸šå‚ä¸è€…", "æœåŠ¡æä¾›å•†", "æ”¿ç­–åˆ¶å®šè€…"],
            "value": f"æ„å»ºã€Œ{topic}ã€ç›¸å…³é¢†åŸŸçš„å®Œæ•´ç”Ÿæ€ç³»ç»Ÿ"
        }
    ]


def intelligent_product_matching(topic, category):
    """æ™ºèƒ½äº§å“åŒ¹é…ï¼šåŸºäºè¯é¢˜è¯­ä¹‰å’Œåˆ†ç±»"""

    # æ ¹æ®åˆ†ç±»å’Œå…³é”®è¯çš„ç»„åˆæ™ºèƒ½ç”Ÿæˆ
    if category == "ç¤¾ä¼š":
        if any(word in topic for word in ["å®‰å…¨", "äº‹æ•…", "é£é™©"]):
            return [
                {
                    "name": "ç¤¾ä¼šå®‰å…¨é¢„è­¦ç³»ç»Ÿ",
                    "type": "æ™ºèƒ½ç›‘æµ‹å¹³å°",
                    "functions": ["é£é™©è¯†åˆ«é¢„è­¦", "åº”æ€¥å“åº”æœºåˆ¶", "å®‰å…¨çŸ¥è¯†æ™®åŠ", "ç¤¾åŒºäº’åŠ©ç½‘ç»œ", "äº‹æ•…æ•°æ®åˆ†æ"],
                    "target_users": ["æ™®é€šå¸‚æ°‘", "ç¤¾åŒºç®¡ç†è€…", "åº”æ€¥éƒ¨é—¨"],
                    "value": "ç»‡å¯†å®‰å…¨é˜²æŠ¤ç½‘ï¼Œä¿éšœç¤¾ä¼šå’Œè°"
                },
                {
                    "name": "å…¬å…±å®‰å…¨å¤§æ•°æ®å¹³å°",
                    "type": "æ”¿åºœå†³ç­–å¹³å°",
                    "functions": ["å®‰å…¨äº‹æ•…ç»Ÿè®¡", "é£é™©å› ç´ åˆ†æ", "é˜²æ§ç­–ç•¥ä¼˜åŒ–", "èµ„æºè°ƒé…å»ºè®®", "æ”¿ç­–æ•ˆæœè¯„ä¼°"],
                    "target_users": ["æ”¿åºœéƒ¨é—¨", "å®‰å…¨ä¸“å®¶", "ç§‘ç ”æœºæ„"],
                    "value": "æ•°æ®èµ‹èƒ½å…¬å…±å®‰å…¨ç®¡ç†ï¼Œæå‡æ²»ç†æ•ˆèƒ½"
                }
            ]

    elif category == "ç§‘æŠ€":
        if "AI" in topic:
            return [
                {
                    "name": "AIä¼¦ç†æ•™è‚²å¹³å°",
                    "type": "Webå¹³å°",
                    "functions": ["AIæŠ€æœ¯ç§‘æ™®", "ä¼¦ç†æ¡ˆä¾‹åˆ†æ", "é£é™©è­¦ç¤ºæ•™è‚²", "æ­£ç¡®ä½¿ç”¨æŒ‡å¯¼", "æ³•å¾‹çŸ¥è¯†æ™®åŠ"],
                    "target_users": ["AIä»ä¸šè€…", "æ™®é€šç”¨æˆ·", "æ•™è‚²æœºæ„"],
                    "value": "æ™®åŠAIä¼¦ç†çŸ¥è¯†ï¼Œæ¨åŠ¨è´Ÿè´£ä»»AIå‘å±•"
                },
                {
                    "name": "AIåº”ç”¨ç›‘ç®¡æ²™ç›’",
                    "type": "Webå¹³å°",
                    "functions": ["AIåº”ç”¨æµ‹è¯•", "é£é™©è¯„ä¼°æ¨¡å‹", "ç›‘ç®¡æ”¿ç­–æ¨¡æ‹Ÿ", "åˆè§„æŒ‡å¯¼æœåŠ¡", "è¡Œä¸šæ ‡å‡†åˆ¶å®š"],
                    "target_users": ["ç›‘ç®¡éƒ¨é—¨", "AIä¼ä¸š", "ç ”ç©¶æœºæ„"],
                    "value": "å¹³è¡¡åˆ›æ–°ä¸ç›‘ç®¡ï¼Œä¿ƒè¿›AIå¥åº·å‘å±•"
                }
            ]

    elif category == "å¥åº·":
        return [
            {
                "name": "å¥åº·ç”Ÿæ´»åŠ©æ‰‹",
                "type": "ç§»åŠ¨APP",
                "functions": ["å¥åº·é£é™©è¯„ä¼°", "ä¸ªæ€§åŒ–å»ºè®®", "å¥åº·çŸ¥è¯†åº“", "åŒ»ç”Ÿåœ¨çº¿å’¨è¯¢", "å¥åº·æ•°æ®è¿½è¸ª"],
                "target_users": ["å¥åº·å…³æ³¨è€…", "æ…¢ç—…æ‚£è€…", "ä¸­è€å¹´ç¾¤ä½“"],
                "value": "ç§‘å­¦ç®¡ç†å¥åº·ï¼Œé¢„é˜²ç–¾ç—…å‘ç”Ÿ"
            },
            {
                "name": "å…¬å…±å«ç”Ÿç›‘æµ‹å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["ç–¾ç—…ç›‘æµ‹é¢„è­¦", "å¥åº·æ•°æ®ç»Ÿè®¡", "ä¼ æ’­é£é™©è¯„ä¼°", "é˜²æ§æªæ–½å»ºè®®", "å¥åº·æ•™è‚²æ¨é€"],
                "target_users": ["ç–¾æ§ä¸­å¿ƒ", "åŒ»ç–—æœºæ„", "æ”¿åºœéƒ¨é—¨"],
                "value": "å®ˆæŠ¤å…¬å…±å«ç”Ÿï¼Œä¿éšœäººæ°‘å¥åº·"
            }
        ]

    elif category == "æ–‡åŒ–":
        return [
            {
                "name": "æ–‡åŒ–ä¼ æ‰¿åˆ›æ–°å¹³å°",
                "type": "å¾®ä¿¡å°ç¨‹åº",
                "functions": ["ä¼ ç»Ÿæ–‡åŒ–æ™®åŠ", "éé—æŠ€è‰ºæ•™å­¦", "åˆ›æ–°åº”ç”¨å±•ç¤º", "æ–‡åŒ–ç¤¾åŒºäº¤æµ", "æ´»åŠ¨ç»„ç»‡æ¨å¹¿"],
                "target_users": ["æ–‡åŒ–çˆ±å¥½è€…", "ä¼ æ‰¿äºº", "æ•™è‚²æœºæ„"],
                "value": "ä¼ æ‰¿ä¼˜ç§€æ–‡åŒ–ï¼Œåˆ›æ–°è¡¨è¾¾æ–¹å¼"
            },
            {
                "name": "æ–‡åŒ–äº§ä¸šå¤§æ•°æ®å¹³å°",
                "type": "Webå¹³å°",
                "functions": ["æ–‡åŒ–æ¶ˆè´¹åˆ†æ", "IPä»·å€¼è¯„ä¼°", "å¸‚åœºè¶‹åŠ¿é¢„æµ‹", "æŠ•èµ„æœºä¼šå‘ç°", "æ”¿ç­–æ•ˆæœè¯„ä¼°"],
                "target_users": ["æ–‡åŒ–ä¼ä¸š", "æŠ•èµ„æœºæ„", "æ”¿åºœæ–‡åŒ–éƒ¨é—¨"],
                "value": "æ•°æ®é©±åŠ¨æ–‡åŒ–äº§ä¸šå‘å±•ï¼Œé‡Šæ”¾æ–‡åŒ–ä»·å€¼"
            }
        ]

    # é»˜è®¤äº§å“åˆ›æ„
    return [
        {
            "name": f"{topic[:20]}æ™ºèƒ½åŠ©æ‰‹",
            "type": "å¾®ä¿¡å°ç¨‹åº",
            "functions": ["é—®é¢˜æ·±åº¦åˆ†æ", "ä¸ªæ€§åŒ–è§£å†³æ–¹æ¡ˆ", "ç”¨æˆ·ç¤¾åŒºäº’åŠ¨", "ä¸“å®¶å’¨è¯¢æœåŠ¡", "æŒç»­ä¼˜åŒ–æ”¹è¿›"],
            "target_users": ["ç›´æ¥å—å½±å“è€…", "è¡Œä¸šä»ä¸šè€…", "å…³æ³¨ç¾¤ä½“"],
            "value": f"ä¸º{topic}ç›¸å…³é—®é¢˜æä¾›ä¸“ä¸šè§£å†³æ–¹æ¡ˆ"
        },
        {
            "name": f"{topic[:20]}ç”Ÿæ€å¹³å°",
            "type": "Webå¹³å°",
            "functions": ["äº§ä¸šé“¾æ•´åˆ", "å¤šæ–¹èµ„æºå¯¹æ¥", "æ ‡å‡†åŒ–æœåŠ¡ä½“ç³»", "æ•°æ®å…±äº«æœºåˆ¶", "ç”Ÿæ€ä»·å€¼åˆ›é€ "],
            "target_users": ["ä¼ä¸šç”¨æˆ·", "æœºæ„ç»„ç»‡", "ä¸“ä¸šäººå£«"],
            "value": f"æ„å»º{topic}é¢†åŸŸçš„å®Œæ•´ç”Ÿæ€ç³»ç»Ÿ"
        }
    ]

def generate_html_report(analysis_results):
    """ç”ŸæˆHTMLåˆ†ææŠ¥å‘Š"""
    print("\nğŸ“„ æ­¥éª¤3: ç”ŸæˆHTMLæŠ¥å‘Š...")
    print("-" * 70)

    date_str = datetime.now().strftime('%Y%m%d')
    report_filename = f"weibo_analysis_report_{date_str}.html"

    html_content = create_html_template(analysis_results)

    with open(report_filename, 'w', encoding='utf-8') as f:
        f.write(html_content)

    print(f"âœ… æŠ¥å‘Šå·²ç”Ÿæˆ: {report_filename}")
    return report_filename

def create_html_template(data):
    """åˆ›å»ºHTMLæŠ¥å‘Šæ¨¡æ¿"""
    html = f"""<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾®åšçƒ­æœåˆ†ææŠ¥å‘Š - {data['timestamp']}</title>
    <style>
        * {{ margin: 0; padding: 0; box-sizing: border-box; }}
        body {{ font-family: 'Microsoft YaHei', sans-serif; line-height: 1.6; color: #333; background: #f5f5f5; }}
        .container {{ max-width: 1200px; margin: 0 auto; padding: 20px; }}
        .header {{ background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; border-radius: 10px; text-align: center; margin-bottom: 30px; }}
        .header h1 {{ font-size: 2.5em; margin-bottom: 10px; }}
        .summary {{ background: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }}
        .topic-card {{ background: white; margin-bottom: 30px; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }}
        .topic-header {{ background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; }}
        .topic-title {{ font-size: 1.5em; margin-bottom: 10px; }}
        .topic-meta {{ font-size: 0.9em; opacity: 0.9; }}
        .topic-content {{ padding: 30px; }}
        .section {{ margin-bottom: 25px; }}
        .section-title {{ font-size: 1.3em; color: #667eea; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #667eea; }}
        .product-grid {{ display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }}
        .product-card {{ background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; }}
        .product-card h4 {{ color: #667eea; margin-bottom: 10px; }}
        .tag {{ display: inline-block; padding: 3px 10px; border-radius: 12px; font-size: 0.85em; margin-left: 10px; }}
        .tag-hot {{ background: #ff6b6b; color: white; }}
        .tag-new {{ background: #4ecdc4; color: white; }}
        .tag-boil {{ background: #ffa502; color: white; }}
        .sources {{ background: #f8f9fa; padding: 15px; border-radius: 8px; }}
        .source-item {{ margin: 10px 0; padding: 10px; background: white; border-radius: 5px; }}
        .footer {{ text-align: center; padding: 30px; color: #666; }}
        ul {{ margin-left: 20px; }}
        li {{ margin: 8px 0; }}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”¥ å¾®åšçƒ­æœåˆ†ææŠ¥å‘Š</h1>
            <p>æ·±åº¦æ´å¯Ÿ Â· èƒŒæ™¯è°ƒç ” Â· äº§å“åˆ›æ„</p>
            <p style="margin-top: 10px;">ç”Ÿæˆæ—¶é—´: {data['timestamp']}</p>
        </div>

        <div class="summary">
            <h2 style="color: #667eea; margin-bottom: 20px;">ğŸ“Š æ•°æ®æ¦‚è§ˆ</h2>
            <p><strong>åˆ†æè¯é¢˜æ•°:</strong> {len(data['topics'])} ä¸ª</p>
            <p><strong>æ•°æ®æ¥æº:</strong> å¾®åšçƒ­æœ + ç™¾åº¦AIæœç´¢</p>
            <p><strong>åˆ†æç»´åº¦:</strong> èƒŒæ™¯è°ƒç ”ã€æ·±åº¦æ´å¯Ÿã€äº§å“åˆ›æ„</p>
        </div>
"""

    # æ·»åŠ æ¯ä¸ªè¯é¢˜çš„åˆ†æ
    for topic in data['topics']:
        html += f"""
        <div class="topic-card">
            <div class="topic-header">
                <h2 class="topic-title">
                    {topic['name']}
                    {f'<span class="tag tag-{topic["tag"].lower() if topic["tag"] else "hot"}">{topic["tag"]}</span>' if topic['tag'] else ''}
                </h2>
                <div class="topic-meta">
                    çƒ­åº¦: {topic['heat']} | åˆ†ç±»: {topic['category']}
                </div>
            </div>
            <div class="topic-content">
                <div class="section">
                    <h3 class="section-title">ğŸ” èƒŒæ™¯æ¥é¾™å»è„‰</h3>
                    <div class="sources">
                        <p><strong>çŠ¶æ€:</strong> {topic['background']['status'] if topic['background'] else 'æœªè·å–'}</p>
"""

        # æ·»åŠ æœç´¢æ¥æº
        if topic['background'] and topic['background']['sources']:
            for source in topic['background']['sources'][:2]:
                html += f"""
                        <div class="source-item">
                            <strong>æ¥æº:</strong> {source['title']}<br>
                            <strong>æ‘˜å½•:</strong> {source['content']}<br>
                            <strong>é“¾æ¥:</strong> <a href="{source['url']}" target="_blank">{source['url']}</a>
                        </div>
"""
        else:
            html += """
                        <p style="color: #999; font-style: italic;">æ³¨: èƒŒæ™¯ä¿¡æ¯éœ€ä½¿ç”¨ç™¾åº¦APIå®æ—¶æœç´¢è·å–</p>
"""

        html += """
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">ğŸ’¡ æ·±åº¦åˆ†æ</h3>
                    <p><strong>ç”¨æˆ·ç—›ç‚¹:</strong> """ + topic['insights']['user_pain_point'] + """</p>
                    <p><strong>å¸‚åœºæœºä¼š:</strong> """ + topic['insights']['market_opportunity'] + """</p>
                    <p><strong>åˆ›æ–°æ–¹å‘:</strong> """ + topic['insights']['innovation_direction'] + """</p>
                </div>

                <div class="section">
                    <h3 class="section-title">ğŸ¯ è½¯ä»¶äº§å“åˆ›æ„</h3>
                    <div class="product-grid">
"""

        # æ·»åŠ AIåˆ†æï¼ˆå¦‚æœå­˜åœ¨ï¼‰
        if 'ai_analysis' in topic and topic['ai_analysis'] and "AIåˆ†æå¤±è´¥" not in topic['ai_analysis']:
            html += f"""
                <div class="section">
                    <h3 class="section-title">ğŸ¤– AIæ·±åº¦åˆ†æ</h3>
                    <p style="color: #4A90E2; font-weight: bold;">{topic['ai_analysis']}</p>
                </div>
"""

        # æ·»åŠ äº§å“åˆ›æ„
        for i, product in enumerate(topic['products'], 1):
            score_info = ""
            if 'fun_score' in product:
                score_info = f"""<p style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 8px 15px; border-radius: 20px; display: inline-block; margin: 10px 0;">
                                è¶£å‘³åº¦:{product.get('fun_score', 0)}åˆ† | æœ‰ç”¨åº¦:{product.get('useful_score', 0)}åˆ†
                            </p>"""

            html += f"""
                        <div class="product-card">
                            <h4>ã€äº§å“{i}ã€‘{product['name']}</h4>
                            <p><strong>ç±»å‹:</strong> {product['type']}</p>
                            {score_info}
                            <p><strong>æ ¸å¿ƒåŠŸèƒ½:</strong></p>
                            <ul>
"""
            for func in product['functions']:
                html += f"                                <li>{func}</li>\n"

            html += f"""
                            </ul>
                            <p><strong>ç›®æ ‡ç”¨æˆ·:</strong> {', '.join(product['target_users'])}</p>
                            <p><strong>å•†ä¸šä»·å€¼:</strong> {product['value']}</p>
                        </div>
"""

        html += """
                    </div>
                </div>
            </div>
        </div>
"""

    # æ·»åŠ é¡µè„š
    html += f"""
        <div class="footer">
            <p>Â© 2025 å¾®åšçƒ­æœåˆ†æç³»ç»Ÿ | æ–œæ å‘½ä»¤: /weibo-analysis</p>
            <p style="margin-top: 10px; font-size: 0.9em;">
                æœ¬æŠ¥å‘Šç”±Claude Codeè‡ªåŠ¨ç”Ÿæˆ | åŸºäºçœŸå®APIæ•°æ®
            </p>
        </div>
    </div>
</body>
</html>
"""
    return html

def save_results(data):
    """ä¿å­˜åˆ†æç»“æœ"""
    timestamp = datetime.now().strftime('%Y%m%d_%H%M')
    filename = f"weibo_analysis_results_{timestamp}.json"

    with open(filename, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print(f"ğŸ’¾ åˆ†æç»“æœå·²ä¿å­˜: {filename}")
    return filename

def print_summary(analysis_results, report_file):
    """æ‰“å°æ‰§è¡Œæ€»ç»“"""
    print("\n" + "=" * 70)
    print("âœ… å¾®åšçƒ­æœåˆ†æå®Œæˆï¼")
    print("=" * 70)
    print(f"ğŸ“Š åˆ†æè¯é¢˜æ•°: {len(analysis_results['topics'])}")
    print(f"ğŸ“„ æŠ¥å‘Šæ–‡ä»¶: {report_file}")
    print(f"ğŸ“ ç»“æœæ–‡ä»¶: weibo_analysis_results_{datetime.now().strftime('%Y%m%d_%H%M')}.json")
    print("=" * 70)
    print("\nğŸ’¡ æç¤º:")
    print("   1. æ‰“å¼€HTMLæŠ¥å‘ŠæŸ¥çœ‹å®Œæ•´åˆ†æç»“æœ")
    print("   2. ä½¿ç”¨ /weibo-analysis å‘½ä»¤å¯é‡æ–°è¿è¡Œåˆ†æ")
    print("   3. æ¯ä¸ªè¯é¢˜éƒ½åŒ…å«èƒŒæ™¯è°ƒç ”å’Œäº§å“åˆ›æ„")
    print("=" * 70)

# ==================== ä¸»å‡½æ•° ====================

def main():
    """ä¸»æ‰§è¡Œå‡½æ•°"""
    print_header()

    try:
        # 1. è·å–çƒ­æœæ•°æ®
        hot_data = get_weibo_hot_data()
        if not hot_data:
            print("âŒ æ— æ³•è·å–çƒ­æœæ•°æ®ï¼Œç¨‹åºé€€å‡º")
            return

        # 2. åˆ†ææ‰€æœ‰è¯é¢˜
        analysis_results = analyze_all_topics(hot_data['list'])

        # 3. ä¿å­˜ç»“æœ
        results_file = save_results(analysis_results)

        # 4. ç”ŸæˆHTMLæŠ¥å‘Š
        report_file = generate_html_report(analysis_results)

        # 5. æ‰“å°æ€»ç»“
        print_summary(analysis_results, report_file)

    except KeyboardInterrupt:
        print("\n\nâš ï¸ ç”¨æˆ·ä¸­æ–­æ“ä½œ")
    except Exception as e:
        print(f"\nâŒ ç¨‹åºæ‰§è¡Œå‡ºé”™: {e}")
        import traceback
        traceback.print_exc()

if __name__ == "__main__":
    main()